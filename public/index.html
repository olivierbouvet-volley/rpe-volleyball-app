<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="RPE Monitor">
    <title>RPE Monitor - P√¥le Espoir Volleyball Sabl√©</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest/manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/img/icon-192.png">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Sticker System CSS -->
    <link rel="stylesheet" href="/css/stickers.css">
    <link rel="stylesheet" href="/css/sticker-collection.css">
    
    <!-- Weekend Match Recap CSS -->
    <link rel="stylesheet" href="/css/weekend-match-recap.css">
    
    <style>
        :root {
            /* Color Palette - Cr√®me naturel & Teal */
            --color-white: rgba(255, 255, 255, 1);
            --color-black: rgba(0, 0, 0, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: #50b8c6;
            --color-teal-400: #2da6b2;
            --color-teal-500: #2180ac;
            --color-teal-600: #1a6a8e;
            --color-teal-700: #145470;
            --color-red-400: #ff5459;
            --color-red-500: #ff1a1a;
            --color-orange-400: #e68161;
            --color-orange-500: #a84b2f;

            /* App specific colors */
            --primary-color: #2180ac;
            --success-color: #10B981;
            --warning-color: #F59E0B;
            --danger-color: #EF4444;

            /* RGB versions for opacity control */
            --color-brown-600-rgb: 94, 82, 64;
            --color-teal-500-rgb: 33, 128, 172;
            --color-slate-900-rgb: 19, 52, 59;
            --color-slate-500-rgb: 98, 108, 113;
            --color-red-500-rgb: 239, 68, 68;

            /* Semantic Color Tokens */
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
            --color-border: rgba(var(--color-brown-600-rgb), 0.2);
            --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
            --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.3);

            /* Typography */
            --font-family-base: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 550;
            --font-weight-bold: 600;
            --line-height-normal: 1.5;
            --line-height-tight: 1.2;

            /* Spacing */
            --space-2: 2px;
            --space-4: 4px;
            --space-8: 8px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;
            --space-48: 48px;

            /* Border Radius */
            --radius-sm: 6px;
            --radius-base: 8px;
            --radius-lg: 12px;
            --radius-full: 9999px;

            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);

            /* Animation */
            --duration-fast: 150ms;
            --duration-normal: 250ms;
            --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* Mobile Responsive Chart */
        @media (max-width: 768px) {
            #cycleChartContainer {
                height: 250px !important;
                min-height: 250px;
            }
        }

        @media (max-width: 480px) {
            #cycleChartContainer {
                height: 220px !important;
                min-height: 220px;
            }
        }

        /* Fullscreen modal responsive */
        @media (max-width: 768px) {
            #cycleChartFullscreenContainer {
                height: 80vh !important;
            }
        }

        /* Landscape mode */
        @media (orientation: landscape) {
            #cycleChartFullscreenContainer {
                height: 90vh !important;
            }
        }


        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-base);
            font-size: var(--font-size-base);
            line-height: var(--line-height-normal);
            color: var(--color-text);
            background-color: var(--color-background);
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-16);
        }

        .screen {
            display: none;
            min-height: 100vh;
        }

        .screen.active {
            display: block;
        }

        /* Login Screen */
        .login-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #2180ac 0%, #4ECDC4 100%);
            padding: var(--space-16);
        }

        .login-card {
            background: white;
            padding: var(--space-48) var(--space-32);
            border-radius: var(--radius-lg);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
            border: 1px solid rgba(33, 128, 172, 0.1);
        }

        .login-title {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-8);
            color: var(--color-text);
        }

        .login-subtitle {
            color: var(--color-text-secondary);
            margin-bottom: var(--space-32);
            font-size: var(--font-size-base);
        }

        .form-group {
            margin-bottom: var(--space-20);
            text-align: left;
        }

        .form-label {
            display: block;
            margin-bottom: var(--space-8);
            font-weight: var(--font-weight-medium);
            color: var(--color-text);
        }

        .form-control {
            width: 100%;
            padding: var(--space-12) var(--space-16);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            background-color: white;
            color: var(--color-text);
            transition: all var(--duration-fast) var(--ease-standard);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px var(--color-focus-ring);
            background-color: white;
        }

        .form-control::placeholder {
            color: #9ca3af;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-12) var(--space-24);
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--duration-normal) var(--ease-standard);
            border: none;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Dashboard Layout - Dark Mode */
        .dashboard {
            padding: var(--space-20) 0;
        }

        .header {
            background: var(--netflix-black-light);
            border-bottom: 1px solid var(--color-card-border);
            padding: var(--space-20) var(--space-16);
            margin-bottom: var(--space-24);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
            flex: 1;
        }

        .player-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--color-primary);
            cursor: pointer;
            flex-shrink: 0;
        }

        .player-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .player-name {
            font-size: var(--font-size-base);
            color: var(--color-text-secondary);
            margin: 0;
            padding: 0;
        }

        .header-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
            margin: 0;
            padding: 0;
        }

        .header-subtitle {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            margin-top: var(--space-4);
        }

        .logout-btn {
            background: var(--netflix-gray);
            color: var(--color-text);
            padding: var(--space-8) var(--space-16);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            transition: all var(--duration-fast);
        }

        .logout-btn:hover {
            background: var(--netflix-gray-light);
            border-color: var(--netflix-red);
        }

        .btn-export-pdf {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        .btn-export-pdf:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
            font-size: var(--font-size-sm);
        }

        /* Player Avatar */
        .player-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--color-border);
            transition: transform 0.2s ease;
        }

        .player-avatar:hover {
            transform: scale(1.05);
        }

        .image-upload-container {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .image-upload-container:hover {
            transform: translateY(-2px);
        }

        /* Status Gauge */
        .status-gauge {
            position: relative;
            width: 100%;
            height: 8px;
            background: var(--color-gray-200);
            border-radius: var(--radius-full);
            overflow: hidden;
        }

        .status-gauge-fill {
            height: 100%;
            border-radius: var(--radius-full);
            transition: width 0.3s ease, background-color 0.3s ease;
        }

        .status-gauge-fill.optimal {
            background: linear-gradient(90deg, #10B981, #34D399);
        }

        .status-gauge-fill.attention {
            background: linear-gradient(90deg, #F59E0B, #FBBF24);
        }

        .status-gauge-fill.critical {
            background: linear-gradient(90deg, #EF4444, #F87171);
        }

        /* Filter Buttons */
        .filter-buttons {
            display: flex;
            gap: var(--space-12);
            margin-bottom: var(--space-24);
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: var(--space-8) var(--space-16);
            border-radius: var(--radius-base);
            border: 2px solid var(--color-border);
            background: var(--color-surface);
            color: var(--color-text);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
        }

        .filter-btn.active {
            border-color: var(--color-primary);
            background: rgba(var(--color-teal-500-rgb), 0.1);
            color: var(--color-primary);
        }

        .filter-btn.optimal {
            border-color: var(--success-color);
        }

        .filter-btn.optimal.active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }

        .filter-btn.attention {
            border-color: var(--warning-color);
        }

        .filter-btn.attention.active {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-color);
        }

        .filter-btn.critical {
            border-color: var(--danger-color);
        }

        .filter-btn.critical.active {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger-color);
        }

        /* Cycle Phase Filter Buttons */
        .cycle-filter-btn {
            padding: var(--space-8) var(--space-12);
            border-radius: var(--radius-base);
            border: 2px solid var(--color-border);
            background: var(--color-surface);
            color: var(--color-text);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
        }

        .cycle-filter-btn.active {
            border-color: var(--color-primary);
            background: rgba(var(--color-teal-500-rgb), 0.1);
            color: var(--color-primary);
        }

        .cycle-filter-btn.menstrual {
            border-color: #e91e63;
        }
        .cycle-filter-btn.menstrual.active {
            background: rgba(233, 30, 99, 0.1);
            color: #e91e63;
        }

        .cycle-filter-btn.follicular {
            border-color: #4caf50;
        }
        .cycle-filter-btn.follicular.active {
            background: rgba(76, 175, 80, 0.1);
            color: #4caf50;
        }

        .cycle-filter-btn.ovulatory {
            border-color: #ff9800;
        }
        .cycle-filter-btn.ovulatory.active {
            background: rgba(255, 152, 0, 0.1);
            color: #ff9800;
        }

        .cycle-filter-btn.luteal {
            border-color: #9c27b0;
        }
        .cycle-filter-btn.luteal.active {
            background: rgba(156, 39, 176, 0.1);
            color: #9c27b0;
        }

        .cycle-filter-btn.unknown {
            border-color: #9e9e9e;
        }
        .cycle-filter-btn.unknown.active {
            background: rgba(158, 158, 158, 0.1);
            color: #9e9e9e;
        }

        /* Player Card with Photo */
        .player-card {
            display: flex;
            align-items: center;
            gap: var(--space-16);
            padding: var(--space-16);
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-base);
            margin-bottom: var(--space-12);
            transition: all var(--duration-fast) var(--ease-standard);
        }

        .player-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .player-card-info {
            flex: 1;
        }

        .player-card-name {
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
            margin-bottom: var(--space-4);
        }

        .player-card-status {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-8);
        }

        /* Add Player Modal - Dark Mode */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        .modal.active {
            display: flex;
            pointer-events: auto;
        }

        .modal-content {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            padding: var(--space-24);
            border-bottom: 1px solid var(--color-border);
        }

        .modal-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
        }

        .modal-body {
            padding: var(--space-24);
        }

        .modal-footer {
            padding: var(--space-16) var(--space-24);
            border-top: 1px solid var(--color-border);
            display: flex;
            justify-content: flex-end;
            gap: var(--space-12);
        }

        .btn-secondary {
            background: var(--color-surface);
            color: var(--color-text);
            border: 1px solid var(--color-border);
            transition: all var(--duration-fast);
        }

        .btn-secondary:hover {
            background: var(--color-gray-200);
            border-color: var(--color-border);
        }

        /* Image Upload */
        .image-upload-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-16);
            padding: var(--space-24);
            border: 2px dashed var(--color-border);
            border-radius: var(--radius-base);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
        }

        .image-upload-container:hover {
            border-color: var(--color-primary);
            background: rgba(var(--color-teal-500-rgb), 0.05);
        }

        .image-preview {
            width: 120px;
            height: 120px;
            border-radius: var(--radius-full);
            object-fit: cover;
            border: 3px solid var(--color-border);
        }

        .upload-icon {
            font-size: 48px;
            color: var(--color-text-secondary);
        }

        /* Team Grid */
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-16);
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            margin-bottom: var(--space-24);
            border: 1px solid var(--color-card-border);
            overflow-x: auto;
            position: relative;
            z-index: 100;
        }

        .nav-tab {
            flex: 1;
            padding: var(--space-12) var(--space-16);
            text-align: center;
            border-radius: var(--radius-base);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
            font-weight: var(--font-weight-medium);
            white-space: nowrap;
            min-width: fit-content;
            position: relative;
            z-index: 101;
        }

        .nav-tab.active {
            background: var(--color-primary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Cards - Netflix Dark Style */
        .card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            margin-bottom: var(--space-24);
            box-shadow: var(--shadow-md);
            transition: all var(--duration-normal) var(--ease-standard);
        }

        .card:hover {
            border-color: rgba(229, 9, 20, 0.3);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }

        .card-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-16);
            color: var(--color-text);
        }

        /* Metrics Grid - Dark Mode Enhanced */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-16);
            margin-bottom: var(--space-24);
        }

        .metric-card {
            background: var(--netflix-gray-dark);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: all var(--duration-normal) var(--ease-standard);
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: rgba(229, 9, 20, 0.3);
        }

        .metric-value {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
            margin-bottom: var(--space-8);
        }

        .metric-label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-12);
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .team-grid {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                overflow-x: scroll;
            }

            .card {
                padding: var(--space-16);
            }

            .card-title {
                font-size: var(--font-size-base);
                margin-bottom: var(--space-12);
            }

            #cycleChartContainer {
                height: 240px !important;
            }

            /* L√©gende du graphique du cycle responsive */
            #cycleChartContainer canvas {
                max-height: 240px !important;
            }

            /* Wrapper pour la l√©gende scrollable */
            .chart-legend-wrapper {
                overflow-x: auto;
                white-space: nowrap;
            }
        }

        /* Styles pour les boutons d'action des blessures */
        .btn-edit-injury,
        .btn-recover-injury {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            padding: 6px 10px;
            margin: 0 4px;
            border-radius: var(--radius-base);
            transition: all var(--duration-fast) var(--ease-standard);
        }

        .btn-edit-injury {
            color: var(--color-primary);
        }

        .btn-edit-injury:hover {
            background: rgba(var(--color-teal-500-rgb), 0.1);
        }

        .btn-recover-injury {
            color: var(--success-color);
        }

        .btn-recover-injury:hover {
            background: rgba(16, 185, 129, 0.1);
        }

        /* Style pour les filtres de blessures */
        .injury-filter-btn.active {
            background: var(--color-primary) !important;
            color: white !important;
        }

        /* Animations pour messages de succ√®s */
        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        /* Hover effect pour les cartes de gestion - Dark Mode */
        .player-management-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
            border-color: rgba(229, 9, 20, 0.4);
        }

        /* Toggle vue Cartes / Tableau - Dark Mode */
        .view-toggle-btn.active {
            background: var(--netflix-red) !important;
            color: white !important;
            box-shadow: 0 2px 8px rgba(229, 9, 20, 0.4);
        }

        /* Pastilles temps de jeu - effet hover */
        .time-played-badge:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .time-played-badge:active {
            transform: scale(0.95);
        }

        /* Tableau Excel style - Dark Mode */
        #playersTable {
            table-layout: auto;
        }

        #playersTable th {
            position: sticky;
            top: 0;
            background: var(--netflix-gray-dark);
            z-index: 10;
            color: var(--color-text);
            border-bottom: 2px solid var(--netflix-red);
        }

        #playersTable tbody tr {
            transition: background var(--duration-fast);
        }

        #playersTable tbody tr:hover {
            background: var(--netflix-gray-dark);
        }

        #playersTable td {
            padding: 8px 12px;
            border-bottom: 1px solid var(--color-border);
            vertical-align: middle;
            color: var(--color-text);
        }

        /* Cellules √©ditables */
        .editable-cell {
            cursor: pointer;
            position: relative;
            min-height: 24px;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all var(--duration-fast);
        }

        .editable-cell:hover {
            background: #f0f9ff;
            outline: 1px solid #3b82f6;
        }

        .editable-cell.editing {
            background: white;
            outline: 2px solid var(--color-primary);
        }

        .editable-cell input,
        .editable-cell select {
            width: 100%;
            border: none;
            background: transparent;
            padding: 2px 4px;
            font-size: var(--font-size-sm);
            font-family: inherit;
        }

        .editable-cell input:focus,
        .editable-cell select:focus {
            outline: none;
        }

        /* Indicateur de sauvegarde */
        .save-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-left: 4px;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .save-indicator.saving {
            background: #f59e0b;
        }

        .save-indicator.saved {
            background: #10b981;
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-messaging-compat.js"></script>
    
    <!-- Configuration Firebase Prod/Dev -->
    <script src="/js/config/firebase-config-prod.js"></script>
    <script src="/js/config/firebase-config-dev.js"></script>
    <script src="/js/config/firebase-loader.js"></script>
</head>
<body>
    <!-- Login Screen - Version simplifi√©e sans r√¥le -->
    <div id="loginScreen" class="screen active">
        <div class="login-screen">
            <div class="login-card">
                <h1 class="login-title">RPE Monitor</h1>
                <p class="login-subtitle">P√¥le Espoir Volleyball Sabl√©</p>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="playerName" class="form-label">Nom</label>
                        <input type="text" id="playerName" class="form-control" placeholder="Votre nom" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="teamCode" class="form-label">Mot de passe</label>
                        <input type="password" id="teamCode" class="form-control" placeholder="Mot de passe" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="btn btn-primary">Se connecter</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Player Dashboard -->
    <div id="playerScreen" class="screen">
        <div class="header">
            <div class="container">
                <div class="header-content">
                    <div class="header-left">
                        <img id="playerHeaderPhoto" class="player-avatar" src="/img/default-avatar.png" alt="Photo" title="Cliquez pour changer la photo" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid #2180ac; cursor: pointer;">
                        <div class="player-info">
                            <h1 class="header-title">Mon Dashboard</h1>
                            <div class="player-name" id="playerHeaderName">--</div>
                        </div>
                    </div>
                    <div class="header-right">
                        <button class="btn" onclick="openSettingsModal()" style="background: #667eea; color: white; padding: 8px 12px; font-size: 12px;">‚öôÔ∏è</button>
                        <button class="btn logout-btn" onclick="logout()" style="padding: 8px 12px; font-size: 12px;">‚Ü©Ô∏è</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Zone de notifications pour le dashboard joueur -->
        <div class="container">
            <!-- Banni√®re de p√©riode de repos -->
            <div id="restPeriodBanner" style="display: none; margin-top: 20px;"></div>
            <!-- Prompt pour activer les notifications push -->
            <div id="notificationPromptContainer" style="margin-top: 20px;"></div>
            <!-- Notifications d'anniversaire et messages urgents -->
            <div id="playerNotificationsContainer"></div>
        </div>
        
        <div class="container dashboard">
            <div class="nav-tabs">
                <div class="nav-tab active" data-tab="dashboard" onclick="switchTab('dashboard')">üìä Dashboard</div>
                <div class="nav-tab" data-tab="checkin" onclick="switchTab('checkin')">‚úÖ Check-in</div>
                <div class="nav-tab" data-tab="logrpe" onclick="switchTab('logrpe')">üìù Log RPE</div>
                <div class="nav-tab" data-tab="loadcalc" onclick="switchTab('loadcalc')">üí™ Calculateur</div>
                <div class="nav-tab" data-tab="matchs" onclick="switchTab('matchs')">‚öΩ Matchs</div>
            </div>

            <!-- Dashboard Tab -->
            <div id="dashboardTab" class="tab-content active">
                <!-- Widget Streak Check-in -->
                <div id="streakWidget" style="margin-bottom: var(--space-16); display: none;"></div>
                
                <!-- Widget Progression Entra√Ænement -->
                <div id="trainingProgressWidget" style="margin-bottom: var(--space-16); display: none;"></div>
                
                <!-- Widget Collection Stickers -->
                <div id="stickerWidget" style="margin-bottom: var(--space-16); display: none;"></div>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="readinessScore">--</div>
                        <div class="metric-label">Score pr√©paration</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="currentStatus">--</div>
                        <div class="metric-label">√âtat actuel</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">Votre statut</h3>
                    <div style="margin-bottom: var(--space-16);">
                        <div style="font-size: var(--font-size-lg); font-weight: 600; margin-bottom: var(--space-8);">
                            Score: <span id="currentScore">--</span>
                        </div>
                        <div class="status-gauge" style="margin-bottom: var(--space-8);">
                            <div id="statusGauge" class="status-gauge-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div id="playerStatusInfo"></div>
                </div>
                <div class="card">
                    <h3 class="card-title">Volume d'entra√Ænement</h3>
                    <div style="display: grid; gap: var(--space-16);">
                        <!-- Volume Hebdomadaire -->
                        <div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-8);">
                                <span style="font-weight: 600;">Cette semaine</span>
                                <span style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-primary);" id="weeklyHours">0h</span>
                            </div>
                            <div class="status-gauge" style="margin-bottom: var(--space-8);">
                                <div id="weeklyGauge" class="status-gauge-fill optimal" style="width: 0%"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: var(--font-size-sm); color: var(--color-text-secondary);">
                                <span>Objectif: 20h</span>
                                <span>Moyenne √©quipe: <span id="teamWeeklyAvg">0h</span></span>
                            </div>
                        </div>
                        
                        <!-- Volume Mensuel -->
                        <div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-8);">
                                <span style="font-weight: 600;">Ce mois</span>
                                <span style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-primary);" id="monthlyHours">0h</span>
                            </div>
                        </div>
                        
                        <!-- Volume Annuel -->
                        <div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-8);">
                                <span style="font-weight: 600;">Cette ann√©e</span>
                                <span style="font-size: var(--font-size-lg); font-weight: 600; color: var(--color-primary);" id="yearlyHours">0h</span>
                            </div>
                            <div class="status-gauge" style="margin-bottom: var(--space-8);">
                                <div id="yearlyGauge" class="status-gauge-fill optimal" style="width: 0%"></div>
                            </div>
                            <div style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">
                                Objectif annuel: 720h
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card" style="display: none;">
                    <h3 class="card-title">Mon profil</h3>
                    <div style="display: flex; align-items: center; gap: var(--space-16); margin-bottom: var(--space-16);">
                        <img id="playerProfilePhoto" src="/img/default-avatar.png" alt="Photo de profil" style="width: 112px; height: 112px; border-radius: 50%; object-fit: cover;" onerror="this.src='/img/default-avatar.png'">
                        <div>
                            <button class="btn btn-secondary" onclick="document.getElementById('profilePhotoInput').click()">üì∑ Changer ma photo</button>
                            <input type="file" id="profilePhotoInput" accept="image/*" style="display: none;" onchange="uploadProfilePhoto(event)">
                        </div>
                    </div>
                    <div id="playerProfileInfo"></div>
                </div>

                <!-- Graphique Tendance Forme (15 jours) -->
                <div class="card">
                    <h3 class="card-title">üìà Tendance Forme</h3>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm); margin-bottom: var(--space-16);">
                        Score de forme bas√© sur vos check-ins des 15 derniers jours
                    </p>
                    <div style="height: 250px;">
                        <canvas id="formTrendChart"></canvas>
                    </div>
                </div>

                <!-- Graphique Hebdomadaire (8 semaines + moyenne √©quipe) -->
                <div class="card">
                    <h3 class="card-title">üìä Volume Hebdomadaire</h3>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm); margin-bottom: var(--space-16);">
                        Mes heures vs moyenne √©quipe sur les 8 derni√®res semaines
                    </p>
                    <div style="height: 300px;">
                        <canvas id="weeklyTrainingChart"></canvas>
                    </div>
                </div>

                <!-- Graphique du Cycle Menstruel -->
                <div class="card" style="margin-bottom: var(--space-24);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-16);">
                        <h3 class="card-title" style="margin: 0;">ü©∏ Cycle Menstruel</h3>
                        <div style="display: flex; gap: 8px;">
                            <button id="correctCycleBtn" type="button" class="btn btn-secondary btn-sm" title="Corriger la date de mon dernier J1">
                                üìÖ Corriger mon J1
                            </button>
                            <button id="cycleChartFullscreenBtn" type="button" style="background: none; border: none; cursor: pointer; font-size: 20px; padding: 4px 8px;" title="Mode plein √©cran">
                                ‚õ∂
                            </button>
                        </div>
                    </div>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm); margin-bottom: var(--space-8);">
                        Suivi de votre cycle (phases et sympt√¥mes)
                    </p>
                    <div id="cycleNavigation" style="display: flex; gap: 8px; margin-bottom: var(--space-16);">
                        <button class="btn btn-secondary btn-sm" data-cycle-offset="0" id="currentCycleBtn" style="background-color: #667eea; color: white;">Cycle Actuel</button>
                        <button class="btn btn-secondary btn-sm" data-cycle-offset="-1">C-1</button>
                        <button class="btn btn-secondary btn-sm" data-cycle-offset="-2">C-2</button>
                        <button class="btn btn-secondary btn-sm" data-cycle-offset="-3">C-3</button>
                    </div>
                    <div id="cycleChartContainer" style="height: 320px; position: relative; margin-bottom: var(--space-16);">
                        <canvas id="cycleChart"></canvas>
                    </div>
                    <div id="cycleChartEmpty" style="text-align: center; padding: 40px; color: var(--color-text-secondary); display: none;">
                        <div style="font-size: 32px; margin-bottom: 8px;">üìä</div>
                        <p>Commencez √† enregistrer vos donn√©es pour voir votre cycle</p>
                    </div>
                </div>
                
                <!-- Fullscreen Modal pour le Graphique du Cycle -->
                <div id="cycleChartFullscreenModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: white; z-index: 9999; overflow: auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px; background: var(--color-surface); border-bottom: 1px solid var(--color-border); position: sticky; top: 0;">
                        <h3 style="margin: 0; color: var(--color-text);">ü©∏ Cycle Menstruel</h3>
                        <button id="cycleChartCloseFullscreenBtn" type="button" style="background: none; border: none; cursor: pointer; font-size: 24px; padding: 4px 8px;">
                            ‚úï
                        </button>
                    </div>
                    <div style="padding: 16px;">
                        <div id="cycleChartFullscreenContainer" style="height: 500px; width: 100%; position: relative;">
                            <!-- Chart sera dupliqu√© ici -->
                        </div>
                    </div>
                </div>

                <!-- Modal Correction J1 -->
                <div id="correctCycleModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
                    <div style="background: white; border-radius: 12px; padding: 24px; max-width: 400px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
                        <h3 style="margin: 0 0 16px 0; color: var(--color-text);">üìÖ Corriger mon J1</h3>
                        <p style="color: var(--color-text-secondary); font-size: 14px; margin-bottom: 16px;">
                            Si vous avez oubli√© de d√©clarer votre J1 lors d'un check-in, vous pouvez le corriger ici. 
                            S√©lectionnez la date de votre dernier Jour 1 (premier jour de vos r√®gles).
                        </p>
                        
                        <div style="margin-bottom: 16px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: var(--color-text);">
                                Date du dernier J1:
                            </label>
                            <input type="date" id="correctCycleDateInput" 
                                   style="width: 100%; padding: 10px; border: 1px solid var(--color-border); border-radius: 6px; font-size: 16px;"
                                   max="">
                        </div>
                        
                        <div id="correctCyclePreview" style="background: var(--color-cream-50); padding: 12px; border-radius: 6px; margin-bottom: 16px; display: none;">
                            <p style="margin: 0; font-size: 14px; color: var(--color-text-secondary);">
                                <strong>Aper√ßu:</strong> Avec cette date, vous serez √† <strong id="correctCycleDayPreview">J?</strong> aujourd'hui.
                            </p>
                        </div>
                        
                        <div style="display: flex; gap: 12px;">
                            <button id="cancelCorrectCycleBtn" type="button" class="btn btn-secondary" style="flex: 1;">
                                Annuler
                            </button>
                            <button id="confirmCorrectCycleBtn" type="button" class="btn btn-primary" style="flex: 1;">
                                Confirmer
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Recommandations d'Entra√Ænement par Phase du Cycle -->
                <div class="card" style="margin-top: var(--space-24); clear: both;">
                    <h3 class="card-title">üèãÔ∏è Recommandations d'Entra√Ænement</h3>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm); margin-bottom: var(--space-16);">
                        Adapt√©es √† votre phase du cycle menstruel
                    </p>
                    <div id="recommendationsContainer" style="min-height: 100px;">
                        <!-- Les recommandations seront charg√©es dynamiquement -->
                        <div style="text-align: center; padding: 40px; color: var(--color-text-secondary);">
                            <div style="font-size: 32px; margin-bottom: 8px;">‚è≥</div>
                            Chargement des recommandations...
                        </div>
                    </div>
                </div>

                <!-- Graphique Mensuel (depuis octobre + max + moyenne) -->
                <div class="card">
                    <h3 class="card-title">üìÖ Volume Mensuel</h3>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm); margin-bottom: var(--space-16);">
                        Mes heures vs max √©quipe et moyenne depuis octobre
                    </p>
                    <div style="height: 300px;">
                        <canvas id="monthlyTrainingChart"></canvas>
                    </div>
                </div>

                <!-- Objectif Annuel avec barre de progression -->
                <div class="card">
                    <h3 class="card-title">üéØ Objectif Annuel</h3>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm); margin-bottom: var(--space-16);">
                        Progression vers l'objectif de 720 heures d'entra√Ænement
                    </p>
                    <div style="background: #e5e7eb; border-radius: 10px; height: 24px; overflow: hidden; margin-bottom: var(--space-12);">
                        <div id="annualProgressBar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #667eea, #818cf8); border-radius: 10px; transition: width 0.5s ease;"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span id="annualProgressText" style="font-weight: 600; color: var(--color-primary);">0h / 720h (0%)</span>
                        <span id="annualProgressDetails" style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Chargement...</span>
                    </div>
                </div>
            </div>

            <!-- Check-in Tab -->
            <div id="checkinTab" class="tab-content">
                <!-- Sous-onglets pour Check-in -->
                <div style="display: flex; gap: var(--space-8); margin-bottom: var(--space-24); border-bottom: 2px solid var(--color-border); padding-bottom: var(--space-8);">
                    <button class="btn btn-secondary" id="checkinTodayBtn" onclick="showCheckinSubTab('today')" style="background: var(--color-primary); color: white;">Aujourd'hui</button>
                    <button class="btn btn-secondary" id="checkinYesterdayBtn" onclick="showCheckinSubTab('yesterday')">Veille (J-1)</button>
                    <button class="btn btn-secondary" id="checkinDayBeforeBtn" onclick="showCheckinSubTab('daybefore')">Avant-veille (J-2)</button>
                </div>
                
                <!-- Check-in Aujourd'hui -->
                <div class="card" id="checkinTodayCard">
                    <h3 class="card-title">Check-in quotidien</h3>
                    <p style="color: var(--color-text-secondary); margin-bottom: var(--space-24);">
                        Remplissez votre check-in chaque matin avant midi
                    </p>
                    <form id="checkinForm">
                        <div class="form-group">
                            <label class="form-label">Qualit√© du sommeil (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="sleepQuality" style="display:none;">
                            <div style="display:none;"><span id="sleepValue">7</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau de courbatures (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="soreness" style="display:none;">
                            <div style="display:none;"><span id="sorenessValue">5</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau de stress (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="stress" style="display:none;">
                            <div style="display:none;"><span id="stressValue">5</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Humeur g√©n√©rale (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="mood" style="display:none;">
                            <div style="display:none;"><span id="moodValue">7</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau d'√©nergie g√©n√©ral (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="energy" style="display:none;">
                            <div style="display:none;"><span id="energyValue">7</span>/10</div>
                        </div>
                        
                        <!-- ============================================== -->
                        <!-- SECTION CYCLE MENSTRUEL - NOUVEAU MODULE 1 & 2 -->
                        <!-- ============================================== -->
                        <div id="cycleSection" style="margin-top: var(--space-24); padding-top: var(--space-16); border-top: 2px solid var(--color-border);">
                            <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: var(--space-16); color: var(--color-text); font-size: 16px;">
                                üå∏ Suivi du Cycle
                                <span style="font-size: 12px; font-weight: normal; color: var(--color-text-secondary);">(optionnel)</span>
                            </h3>
                            
                            <!-- Question J1-J8 - Jour du cycle ? -->
                            <div class="form-group" style="background: #fdf2f8; padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                                <label class="form-label" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                                    <span style="font-size: 18px;">ü©∏</span>
                                    <span>En r√®gles ? S√©lectionne le jour</span>
                                </label>
                                <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
                                    <button type="button" class="cycle-day-btn" data-day="1" 
                                            style="width: 40px; height: 40px; padding: 0; border: 2px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        J1
                                    </button>
                                    <button type="button" class="cycle-day-btn" data-day="2" 
                                            style="width: 40px; height: 40px; padding: 0; border: 2px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        J2
                                    </button>
                                    <button type="button" class="cycle-day-btn" data-day="3" 
                                            style="width: 40px; height: 40px; padding: 0; border: 2px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        J3
                                    </button>
                                    <button type="button" class="cycle-day-btn" data-day="4" 
                                            style="width: 40px; height: 40px; padding: 0; border: 2px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        J4
                                    </button>
                                    <button type="button" class="cycle-day-btn" data-day="5" 
                                            style="width: 40px; height: 40px; padding: 0; border: 2px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        J5
                                    </button>
                                    <button type="button" class="cycle-day-btn" data-day="6" 
                                            style="width: 40px; height: 40px; padding: 0; border: 2px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        J6
                                    </button>
                                    <button type="button" class="cycle-day-btn" data-day="7" 
                                            style="width: 40px; height: 40px; padding: 0; border: 2px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        J7
                                    </button>
                                    <button type="button" class="cycle-day-btn" data-day="8" 
                                            style="width: 40px; height: 40px; padding: 0; border: 2px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        J8
                                    </button>
                                </div>
                                <div style="margin-top: 12px; text-align: center;">
                                    <button type="button" class="cycle-day-btn" data-day="0" 
                                            style="padding: 8px 24px; border: 2px solid #e5e7eb; background: white; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s;">
                                        Non
                                    </button>
                                </div>
                                <input type="hidden" id="cycleDay" value="">
                            </div>
                            
                            <!-- Section SPM - Affich√©e si Non aux r√®gles -->
                            <div id="spmSection" style="display: none; background: #fffbeb; padding: 16px; border-radius: 12px; margin-bottom: 16px;">
                                <label class="form-label" style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
                                    <span style="font-size: 18px;">üåô</span>
                                    <span>Ressens-tu des sympt√¥mes pr√©menstruels (SPM) ?</span>
                                </label>
                                
                                <!-- Crampes abdominales -->
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                    <span style="font-size: 20px; width: 30px; text-align: center;">ü§ï</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Crampes abdominales</div>
                                        <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                            <button type="button" class="spm-badge" data-symptom="spmCramps" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Irritabilit√© -->
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                    <span style="font-size: 20px; width: 30px; text-align: center;">üò†</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Irritabilit√©</div>
                                        <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                            <button type="button" class="spm-badge" data-symptom="spmIrritability" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Ballonnements -->
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                    <span style="font-size: 20px; width: 30px; text-align: center;">ü´Ñ</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Ballonnements</div>
                                        <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                            <button type="button" class="spm-badge" data-symptom="spmBloating" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Maux de t√™te -->
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                    <span style="font-size: 20px; width: 30px; text-align: center;">ü§ï</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Maux de t√™te</div>
                                        <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                            <button type="button" class="spm-badge" data-symptom="spmHeadache" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Fatigue inhabituelle -->
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                    <span style="font-size: 20px; width: 30px; text-align: center;">üò¥</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Fatigue inhabituelle</div>
                                        <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                            <button type="button" class="spm-badge
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                            <button type="button" class="spm-badge" data-symptom="spmFatigue" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Proximit√© des r√®gles - Affich√© si sympt√¥mes SPM coch√©s -->
                                <div id="periodProximitySection" style="display: none; padding-top: 12px; border-top: 1px solid #fcd34d;">
                                    <label class="form-label" style="margin-bottom: 12px;">Penses-tu √™tre proche de tes r√®gles ?</label>
                                    <div style="display: flex; gap: 8px;">
                                        <button type="button" class="period-proximity-btn" data-value="notyet" 
                                                style="flex: 1; padding: 10px; border: 2px solid #e5e7eb; background: white; border-radius: 8px; cursor: pointer; font-size: 13px;">
                                            Pas encore
                                        </button>
                                        <button type="button" class="period-proximity-btn" data-value="j5-j3" 
                                                style="flex: 1; padding: 10px; border: 2px solid #e5e7eb; background: white; border-radius: 8px; cursor: pointer; font-size: 13px;">
                                            J-5 √† J-3
                                        </button>
                                        <button type="button" class="period-proximity-btn" data-value="j2-j1" 
                                                style="flex: 1; padding: 10px; border: 2px solid #e5e7eb; background: white; border-radius: 8px; cursor: pointer; font-size: 13px;">
                                            J-2 / J-1
                                        </button>
                                    </div>
                                    <input type="hidden" id="periodProximity" value="">
                                </div>
                            </div>
                            
                            <!-- Section 7 Sympt√¥mes Menstruels (0-10) -->
                            <div id="symptomsSection" style="background: #f8fafc; padding: 16px; border-radius: 12px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                    <label class="form-label" style="margin: 0; display: flex; align-items: center; gap: 8px;">
                                        <span style="font-size: 18px;">üìä</span>
                                        <span>Sympt√¥mes Menstruels</span>
                                    </label>
                                    <button type="button" id="toggleSymptomsBtn" onclick="toggleSymptomsVisibility()" 
                                            style="padding: 6px 12px; border: 1px solid #e5e7eb; background: white; border-radius: 6px; cursor: pointer; font-size: 12px; color: #6b7280;">
                                        ‚ñº D√©tailler
                                    </button>
                                </div>
                                
                                <!-- Grille des 7 sympt√¥mes - Masqu√©e par d√©faut -->
                                <div id="symptomsGrid" style="display: none;">
                                    <p style="font-size: 12px; color: #6b7280; margin-bottom: 16px;">
                                        Note tes sympt√¥mes de 0 (aucun) √† 10 (insupportable). Laisse √† 0 si tu n'as pas de sympt√¥me.
                                    </p>
                                    
                                    <!-- Crampes Abdominales -->
                                    <div class="symptom-item" style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                        <span style="font-size: 20px; width: 30px; text-align: center;">ü©∏</span>
                                        <div style="flex: 1;">
                                            <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Crampes Abdominales</div>
                                            <div style="display: flex; gap: 4px;">
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                                <button type="button" class="symptom-badge" data-symptom="cramps" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                            </div>
                                        </div>
                                        <div id="crampsValue" style="min-width: 40px; text-align: center; font-weight: 600; color: #10b981; font-size: 16px;">-</div>
                                    </div>
                                    
                                    <!-- Maux de T√™te -->
                                    <div class="symptom-item" style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                        <span style="font-size: 20px; width: 30px; text-align: center;">ü§ï</span>
                                        <div style="flex: 1;">
                                            <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Maux de T√™te</div>
                                            <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                                <button type="button" class="symptom-badge" data-symptom="headache" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                            </div>
                                        </div>
                                        <div id="headacheValue" style="min-width: 40px; text-align: center; font-weight: 600; color: #10b981; font-size: 16px;">0</div>
                                    </div>
                                    
                                    <!-- Fatigue Excessive -->
                                    <div class="symptom-item" style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                        <span style="font-size: 20px; width: 30px; text-align: center;">üò¥</span>
                                        <div style="flex: 1;">
                                            <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Fatigue Excessive</div>
                                            <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                                <button type="button" class="symptom-badge" data-symptom="fatigue" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                            </div>
                                        </div>
                                        <div id="fatigueValue" style="min-width: 40px; text-align: center; font-weight: 600; color: #10b981; font-size: 16px;">0</div>
                                    </div>
                                    
                                    <!-- Variations d'Humeur -->
                                    <div class="symptom-item" style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                        <span style="font-size: 20px; width: 30px; text-align: center;">üòî</span>
                                        <div style="flex: 1;">
                                            <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Variations d'Humeur</div>
                                            <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                                <button type="button" class="symptom-badge" data-symptom="moodSwings" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                            </div>
                                        </div>
                                        <div id="moodSwingsValue" style="min-width: 40px; text-align: center; font-weight: 600; color: #10b981; font-size: 16px;">0</div>
                                    </div>
                                    
                                    <!-- Ballonnements -->
                                    <div class="symptom-item" style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                        <span style="font-size: 20px; width: 30px; text-align: center;">ü´Ñ</span>
                                        <div style="flex: 1;">
                                            <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Ballonnements</div>
                                            <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                                <button type="button" class="symptom-badge" data-symptom="bloating" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                            </div>
                                        </div>
                                        <div id="bloatingValue" style="min-width: 40px; text-align: center; font-weight: 600; color: #10b981; font-size: 16px;">0</div>
                                    </div>
                                    
                                    <!-- Douleurs Dorsales -->
                                    <div class="symptom-item" style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                        <span style="font-size: 20px; width: 30px; text-align: center;">üîô</span>
                                        <div style="flex: 1;">
                                            <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Douleurs Dorsales</div>
                                            <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                                <button type="button" class="symptom-badge" data-symptom="backPain" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                            </div>
                                        </div>
                                        <div id="backPainValue" style="min-width: 40px; text-align: center; font-weight: 600; color: #10b981; font-size: 16px;">0</div>
                                    </div>
                                    
                                    <!-- Sensibilit√© Mammaire -->
                                    <div class="symptom-item" style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: white; border-radius: 8px;">
                                        <span style="font-size: 20px; width: 30px; text-align: center;">‚ö†Ô∏è</span>
                                        <div style="flex: 1;">
                                            <div style="font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 4px;">Sensibilit√© Mammaire</div>
                                            <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="1" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">1</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="2" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">2</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="3" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">3</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="4" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">4</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="5" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">5</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="6" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">6</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="7" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">7</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="8" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">8</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="9" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">9</button>
                                                <button type="button" class="symptom-badge" data-symptom="breastTenderness" data-value="10" style="width: 28px; height: 28px; padding: 0; border: 1px solid #e5e7eb; background: white; border-radius: 50%; cursor: pointer; font-size: 11px; font-weight: 600;">10</button>
                                            </div>
                                        </div>
                                        <div id="breastTendernessValue" style="min-width: 40px; text-align: center; font-weight: 600; color: #10b981; font-size: 16px;">0</div>
                                    </div>
                                    
                                    <!-- R√©sum√© des sympt√¥mes -->
                                    <div id="symptomsSummary" style="margin-top: 12px; padding: 12px; background: #f0fdf4; border-radius: 8px; display: none;">
                                        <div style="display: flex; justify-content: space-between; align-items: center;">
                                            <span style="font-size: 13px; color: #166534;">Score total sympt√¥mes :</span>
                                            <span id="totalSymptomsScore" style="font-weight: 700; font-size: 16px; color: #166534;">0/70</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Affichage de la phase actuelle (calcul√©e) -->
                            <div id="cyclePhaseDisplay" style="display: none; margin-top: 16px; padding: 12px; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 8px; text-align: center;">
                                <div style="font-size: 12px; color: #0369a1; margin-bottom: 4px;">Phase actuelle du cycle</div>
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                                    <span id="cyclePhaseIcon" style="font-size: 24px;">üå±</span>
                                    <span id="cyclePhaseText" style="font-size: 16px; font-weight: 600; color: #0c4a6e;">J8 - Folliculaire</span>
                                </div>
                            </div>
                        </div>
                        <!-- FIN SECTION CYCLE MENSTRUEL -->
                        
                        <div class="form-group">
                            <label class="form-label">Commentaire (optionnel, 150 caract√®res max)</label>
                            <textarea class="form-control" id="checkinComment" maxlength="150" rows="3" placeholder="Ajoutez un commentaire sur votre √©tat du jour..."></textarea>
                            <div style="text-align: right; margin-top: var(--space-4); font-size: var(--font-size-sm); color: var(--color-text-secondary);"><span id="commentCount">0</span>/150</div>
                        </div>
                        <button type="submit" class="btn btn-primary">Enregistrer le check-in</button>
                    </form>
                    
                    <!-- Historique des 8 derniers check-ins -->
                    <div id="checkinHistorySection" style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                        <h4 style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 16px;">üìã Mes 8 derniers check-ins</h4>
                        <div style="overflow-x: auto;">
                            <div id="checkinHistoryList">
                                <div style="text-align: center; color: #9ca3af; padding: 20px;">Chargement...</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Check-in Veille (J-1) -->
                <div class="card" id="checkinYesterdayCard" style="display: none;">
                    <h3 class="card-title">Rattrapage Check-in - Veille (J-1)</h3>
                    <p style="color: var(--color-text-secondary); margin-bottom: var(--space-24);">
                        Remplissez votre check-in de la veille
                    </p>
                    <form id="checkinYesterdayForm">
                        <div class="form-group">
                            <label class="form-label">Qualit√© du sommeil (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="sleepQualityYesterday" style="display:none;">
                            <div style="display:none;"><span id="sleepValueYesterday">7</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau de courbatures (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="sorenessYesterday" style="display:none;">
                            <div style="display:none;"><span id="sorenessValueYesterday">5</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau de stress (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="stressYesterday" style="display:none;">
                            <div style="display:none;"><span id="stressValueYesterday">5</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Humeur g√©n√©rale (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="moodYesterday" style="display:none;">
                            <div style="display:none;"><span id="moodValueYesterday">7</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau d'√©nergie g√©n√©ral (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="energyYesterday" style="display:none;">
                            <div style="display:none;"><span id="energyValueYesterday">7</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Commentaire (optionnel, 150 caract√®res max)</label>
                            <textarea class="form-control" id="checkinCommentYesterday" maxlength="150" rows="3" placeholder="Ajoutez un commentaire sur votre √©tat de la veille..."></textarea>
                            <div style="text-align: right; margin-top: var(--space-4); font-size: var(--font-size-sm); color: var(--color-text-secondary);"><span id="commentCountYesterday">0</span>/150</div>
                        </div>
                        <button type="submit" class="btn btn-primary">Enregistrer le check-in (J-1)</button>
                    </form>
                </div>
                
                <!-- Check-in Avant-veille (J-2) -->
                <div class="card" id="checkinDayBeforeCard" style="display: none;">
                    <h3 class="card-title">Rattrapage Check-in - Avant-veille (J-2)</h3>
                    <p style="color: var(--color-text-secondary); margin-bottom: var(--space-24);">
                        Remplissez votre check-in de l'avant-veille
                    </p>
                    <form id="checkinDayBeforeForm">
                        <div class="form-group">
                            <label class="form-label">Qualit√© du sommeil (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="sleepQualityDayBefore" style="display:none;">
                            <div style="display:none;"><span id="sleepValueDayBefore">7</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau de courbatures (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="sorenessDayBefore" style="display:none;">
                            <div style="display:none;"><span id="sorenessValueDayBefore">5</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau de stress (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="stressDayBefore" style="display:none;">
                            <div style="display:none;"><span id="stressValueDayBefore">5</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Humeur g√©n√©rale (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="moodDayBefore" style="display:none;">
                            <div style="display:none;"><span id="moodValueDayBefore">7</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau d'√©nergie g√©n√©ral (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="energyDayBefore" style="display:none;">
                            <div style="display:none;"><span id="energyValueDayBefore">7</span>/10</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Commentaire (optionnel, 150 caract√®res max)</label>
                            <textarea class="form-control" id="checkinCommentDayBefore" maxlength="150" rows="3" placeholder="Ajoutez un commentaire sur votre √©tat de l'avant-veille..."></textarea>
                            <div style="text-align: right; margin-top: var(--space-4); font-size: var(--font-size-sm); color: var(--color-text-secondary);"><span id="commentCountDayBefore">0</span>/150</div>
                        </div>
                        <button type="submit" class="btn btn-primary">Enregistrer le check-in (J-2)</button>
                    </form>
                </div>
            </div>

            <!-- RPE Tab -->
            <div id="logrpeTab" class="tab-content">
                <!-- Sous-onglets pour RPE -->
                <div style="display: flex; gap: var(--space-8); margin-bottom: var(--space-24); border-bottom: 2px solid var(--color-border); padding-bottom: var(--space-8);">
                    <button class="btn btn-secondary" id="rpeTodayBtn" onclick="showRpeSubTab('today')" style="background: var(--color-primary); color: white;">Aujourd'hui</button>
                    <button class="btn btn-secondary" id="rpeRattrapageBtn" onclick="showRpeSubTab('rattrapage')">üìÖ Rattrapage</button>
                    <button class="btn btn-secondary" id="rpeDeleteBtn" onclick="showRpeSubTab('delete')" style="margin-left: auto; background: #e74c3c; color: white;">üóëÔ∏è Supprimer un RPE</button>
                </div>
                
                <!-- RPE Aujourd'hui -->
                <div class="card" id="rpeTodayCard">
                    <h3 class="card-title">Enregistrer un RPE</h3>
                    <form id="rpeForm">
                        <!-- √âtape 1: Type d'activit√© avec boutons color√©s -->
                        <div class="form-group" id="rpeStep1">
                            <label class="form-label">Type de session</label>
                            <input type="hidden" id="sessionType" value="">
                            <div class="activity-buttons" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px;">
                                <button type="button" class="activity-btn" data-value="Entrainement" style="background: #3b82f6; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(59,130,246,0.3);">
                                    üèê Entra√Ænement
                                </button>
                                <button type="button" class="activity-btn" data-value="Match" style="background: #ef4444; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(239,68,68,0.3);">
                                    üèÜ Match
                                </button>
                                <button type="button" class="activity-btn" data-value="Preparation Physique" style="background: #10b981; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(16,185,129,0.3);">
                                    üí™ Pr√©pa Physique
                                </button>
                                <button type="button" class="activity-btn" data-value="Muscu+Volley" style="background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%); color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(16,185,129,0.3);">
                                    üí™üèê Muscu + Volley
                                </button>
                                <button type="button" class="activity-btn" data-value="Recuperation Active" style="background: #8b5cf6; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(139,92,246,0.3);">
                                    üßò R√©cup√©ration
                                </button>
                                <button type="button" class="activity-btn" data-value="Activite Physique Annexe" style="background: #f59e0b; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(245,158,11,0.3);">
                                    üö¥ Activit√© Annexe
                                </button>
                            </div>
                        </div>
                        
                        <!-- √âtape 2: Effort ressenti (cach√© initialement) -->
                        <div class="form-group" id="rpeStep2" style="display: none;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <span id="selectedActivityBadge" style="padding: 6px 12px; border-radius: 20px; font-size: 13px; font-weight: 600;"></span>
                                <button type="button" onclick="resetRpeForm()" style="background: none; border: none; color: #666; cursor: pointer; font-size: 12px;">‚úèÔ∏è Modifier</button>
                            </div>
                            <label class="form-label">Effort ressenti (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="rpeValue" style="display:none;">
                            <div style="display:none;"><span id="rpeValueDisplay">5</span>/10</div>
                        </div>
                        
                        <!-- √âtape 3: Dur√©e avec roue (cach√© initialement) -->
                        <div class="form-group" id="rpeStep3" style="display: none;">
                            <label class="form-label">Dur√©e de la session</label>
                            <input type="hidden" id="duration" value="">
                            <div class="duration-wheel" style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 10px;">
                                <button type="button" class="duration-btn" data-minutes="30" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">30'</button>
                                <button type="button" class="duration-btn" data-minutes="45" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">45'</button>
                                <button type="button" class="duration-btn" data-minutes="60" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">60'</button>
                                <button type="button" class="duration-btn" data-minutes="75" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">75'</button>
                                <button type="button" class="duration-btn" data-minutes="90" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">90'</button>
                                <button type="button" class="duration-btn" data-minutes="105" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">105'</button>
                                <button type="button" class="duration-btn" data-minutes="120" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">120'</button>
                                <button type="button" class="duration-btn" data-minutes="150" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">150'</button>
                            </div>
                        </div>
                        
                        <!-- √âtape 4: Performance (cach√© initialement) -->
                        <div class="form-group" id="rpeStep4" style="display: none;">
                            <label class="form-label">Comment je note ma performance (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="performance" style="display:none;">
                            <div style="display:none;"><span id="performanceValue">5</span>/10</div>
                        </div>
                        
                        <!-- √âtape 5: Commentaire et soumission (cach√© initialement) -->
                        <div id="rpeStep5" style="display: none;">
                            <div class="form-group">
                                <label class="form-label">Commentaire (optionnel, 150 caract√®res max)</label>
                                <textarea class="form-control" id="rpeComment" maxlength="150" rows="3" placeholder="Ajoutez un commentaire sur la session..."></textarea>
                                <div style="text-align: right; margin-top: var(--space-4); font-size: var(--font-size-sm); color: var(--color-text-secondary);"><span id="rpeCommentCount">0</span>/150</div>
                            </div>
                            <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 16px;">‚úÖ Enregistrer le RPE</button>
                        </div>
                    </form>
                </div>
                
                <!-- RPE Rattrapage (avec calendrier) -->
                <div class="card" id="rpeRattrapageCard" style="display: none;">
                    <h3 class="card-title">Rattrapage RPE</h3>
                    <p style="color: var(--color-text-secondary); margin-bottom: var(--space-16);">
                        S√©lectionnez la date de la s√©ance que vous avez oubli√©e d'enregistrer
                    </p>
                    <form id="rpeRattrapageForm">
                        <!-- √âtape 0: S√©lection de la date -->
                        <div class="form-group" id="rpeRattrapageStep0">
                            <label class="form-label">Date de la s√©ance</label>
                            <input type="date" id="rattrapageDate" class="form-control" style="padding: 12px; font-size: 16px; border-radius: 8px; border: 2px solid var(--color-border);" required>
                            <p id="rattrapageDateLabel" style="margin-top: 8px; font-weight: 600; color: var(--color-primary); display: none;"></p>
                        </div>

                        <!-- √âtape 1: Type d'activit√© -->
                        <div class="form-group" id="rpeRattrapageStep1" style="display: none;">
                            <label class="form-label">Type de session</label>
                            <input type="hidden" id="sessionTypeRattrapage" value="">
                            <div class="activity-buttons-rattrapage" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 10px;">
                                <button type="button" class="activity-btn-rattrapage" data-value="Entrainement" style="background: #3b82f6; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(59,130,246,0.3);">
                                    üèê Entra√Ænement
                                </button>
                                <button type="button" class="activity-btn-rattrapage" data-value="Match" style="background: #ef4444; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(239,68,68,0.3);">
                                    üèÜ Match
                                </button>
                                <button type="button" class="activity-btn-rattrapage" data-value="Preparation Physique" style="background: #10b981; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(16,185,129,0.3);">
                                    üí™ Pr√©pa Physique
                                </button>
                                <button type="button" class="activity-btn-rattrapage" data-value="Muscu+Volley" style="background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%); color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(16,185,129,0.3);">
                                    üí™üèê Muscu + Volley
                                </button>
                                <button type="button" class="activity-btn-rattrapage" data-value="Recuperation Active" style="background: #8b5cf6; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(139,92,246,0.3);">
                                    üßò R√©cup√©ration
                                </button>
                                <button type="button" class="activity-btn-rattrapage" data-value="Activite Physique Annexe" style="background: #f59e0b; color: white; border: none; padding: 15px 10px; border-radius: 12px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(245,158,11,0.3);">
                                    üö¥ Activit√© Annexe
                                </button>
                            </div>
                        </div>

                        <!-- √âtape 2: Effort ressenti -->
                        <div class="form-group" id="rpeRattrapageStep2" style="display: none;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <span id="selectedActivityBadgeRattrapage" style="padding: 6px 12px; border-radius: 20px; font-size: 13px; font-weight: 600;"></span>
                                <button type="button" onclick="resetRpeFormRattrapage()" style="background: none; border: none; color: #666; cursor: pointer; font-size: 12px;">‚úèÔ∏è Modifier</button>
                            </div>
                            <label class="form-label">Effort ressenti (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="rpeValueRattrapage" style="display:none;">
                            <div style="display:none;"><span id="rpeValueDisplayRattrapage">5</span>/10</div>
                        </div>

                        <!-- √âtape 3: Dur√©e -->
                        <div class="form-group" id="rpeRattrapageStep3" style="display: none;">
                            <label class="form-label">Dur√©e de la session</label>
                            <input type="hidden" id="durationRattrapage" value="">
                            <div class="duration-wheel-rattrapage" style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 10px;">
                                <button type="button" class="duration-btn-rattrapage" data-minutes="30" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">30'</button>
                                <button type="button" class="duration-btn-rattrapage" data-minutes="45" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">45'</button>
                                <button type="button" class="duration-btn-rattrapage" data-minutes="60" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">60'</button>
                                <button type="button" class="duration-btn-rattrapage" data-minutes="75" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">75'</button>
                                <button type="button" class="duration-btn-rattrapage" data-minutes="90" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">90'</button>
                                <button type="button" class="duration-btn-rattrapage" data-minutes="105" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">105'</button>
                                <button type="button" class="duration-btn-rattrapage" data-minutes="120" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">120'</button>
                                <button type="button" class="duration-btn-rattrapage" data-minutes="150" style="width: 60px; height: 60px; border-radius: 50%; border: 3px solid #e5e7eb; background: white; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s;">150'</button>
                            </div>
                        </div>

                        <!-- √âtape 4: Performance -->
                        <div class="form-group" id="rpeRattrapageStep4" style="display: none;">
                            <label class="form-label">Comment je note ma performance (1-10)</label>
                            <input type="range" min="0" max="10" value="0" class="form-control" id="performanceRattrapage" style="display:none;">
                            <div style="display:none;"><span id="performanceValueRattrapage">5</span>/10</div>
                        </div>

                        <!-- √âtape 5: Commentaire et soumission -->
                        <div id="rpeRattrapageStep5" style="display: none;">
                            <div class="form-group">
                                <label class="form-label">Commentaire (optionnel, 150 caract√®res max)</label>
                                <textarea class="form-control" id="rpeCommentRattrapage" maxlength="150" rows="3" placeholder="Ajoutez un commentaire sur cette session..."></textarea>
                                <div style="text-align: right; margin-top: var(--space-4); font-size: var(--font-size-sm); color: var(--color-text-secondary);"><span id="rpeCommentCountRattrapage">0</span>/150</div>
                            </div>
                            <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 16px;">‚úÖ Enregistrer le RPE</button>
                        </div>
                    </form>
                </div>

                <!-- Supprimer un RPE -->
                <div class="card" id="rpeDeleteCard" style="display: none;">
                    <h3 class="card-title">üóëÔ∏è Supprimer un RPE</h3>
                    <p style="color: #666; margin-bottom: var(--space-16);">S√©lectionne un RPE √† supprimer de l'historique (en cas d'erreur)</p>
                    
                    <div class="form-group">
                        <label class="form-label">Historique des RPE</label>
                        <div id="rpeHistoryList" style="max-height: 400px; overflow-y: auto; border: 1px solid var(--color-border); border-radius: 8px; padding: var(--space-12);">
                            <p style="color: var(--color-text-secondary); text-align: center;">Chargement de l'historique...</p>
                        </div>
                    </div>
                    
                    <div id="rpeDeleteInfo" style="background: #fff3cd; border: 1px solid #ffc107; padding: var(--space-12); border-radius: 8px; margin-top: var(--space-16); display: none;">
                        <p style="margin: 0;"><strong>‚ö†Ô∏è √Ä supprimer:</strong></p>
                        <p id="rpeDeleteDetails" style="margin: var(--space-8) 0 0 0;"></p>
                        <button type="button" class="btn btn-danger" id="confirmDeleteBtn" onclick="deleteSelectedRpe()" style="margin-top: var(--space-12); background: #e74c3c; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">Confirmer la suppression</button>
                        <button type="button" class="btn btn-secondary" onclick="cancelDeleteRpe()" style="margin-top: var(--space-12); margin-left: 8px; background: #667eea; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">Annuler</button>
                    </div>
                </div>

                <!-- Historique des 8 derni√®res s√©ances -->
                <div class="card" style="margin-top: var(--space-24);">
                    <h3 class="card-title">üìã Mes 8 derni√®res s√©ances</h3>
                    <p style="color: var(--color-text-secondary); font-size: var(--font-size-sm); margin-bottom: var(--space-16);">
                        Historique r√©cent avec possibilit√© de supprimer la derni√®re saisie
                    </p>
                    <div id="rpeHistoryListContainer" style="max-height: 500px; overflow-y: auto;">
                        <p style="color: #999; text-align: center;">Chargement...</p>
                    </div>
                    <div id="rpeDeleteConfirmZone" style="display: none;"></div>
                </div>
            </div>

            <!-- Calculateur de Charge Tab -->
            <div id="loadcalcTab" class="tab-content">
                <div class="card">
                    <h2 class="card-title">üí™ Calculateur de Charge</h2>
                    <p style="color: var(--color-text-secondary); margin-bottom: var(--space-24);">
                        Visualisez vos maximums et calculez vos charges d'entra√Ænement
                    </p>

                    <!-- Mes Maximums (1RM) -->
                    <div style="background: #f8fafc; border-radius: 12px; padding: var(--space-24); margin-bottom: var(--space-24);">
                        <h3 style="font-size: 18px; font-weight: 600; margin-bottom: var(--space-16); color: #1f2937;">
                            üìä Mes Maximums (1RM)
                        </h3>
                        <div id="playerMaxList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: var(--space-16);">
                            <p style="color: #999;">Chargement de vos donn√©es...</p>
                        </div>
                    </div>

                    <!-- Calculateur -->
                    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: var(--space-24);">
                        <h3 style="font-size: 18px; font-weight: 600; margin-bottom: var(--space-16); color: #1f2937;">
                            üßÆ Calculateur
                        </h3>

                        <!-- S√©lection exercice -->
                        <div class="form-group" style="margin-bottom: var(--space-20);">
                            <label class="form-label" style="font-weight: 600; display: block; margin-bottom: 8px;">Exercice</label>
                            <select id="calcExercise" class="form-control" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px;">
                                <option value="">-- Choisir un exercice --</option>
                                <option value="dc">D√©velopp√© Couch√©</option>
                                <option value="traction">Traction</option>
                                <option value="tirage">Tirage Banc</option>
                                <option value="pullOver">Pull Over</option>
                                <option value="hipThrust">Hip Thrust</option>
                                <option value="sdt">SDT (Soulev√© de Terre)</option>
                                <option value="backSquat">Back Squat</option>
                                <option value="epaule">√âpaule</option>
                            </select>
                        </div>

                        <!-- Affichage du MAX s√©lectionn√© -->
                        <div id="selectedMaxDisplay" style="display: none; background: #dbeafe; border-left: 4px solid #3b82f6; padding: 12px 16px; border-radius: 8px; margin-bottom: var(--space-20);">
                            <div style="font-size: 13px; color: #1e40af; font-weight: 600;">Votre maximum :</div>
                            <div id="selectedMaxValue" style="font-size: 24px; font-weight: 700; color: #1e3a8a; margin-top: 4px;">--</div>
                        </div>

                        <!-- Toggle Mode Calcul -->
                        <div style="margin-bottom: var(--space-20);">
                            <label class="form-label" style="font-weight: 600; display: block; margin-bottom: 8px;">Mode de calcul</label>
                            <div style="display: flex; gap: 12px;">
                                <button onclick="switchCalcMode('percentage')" id="percentageModeBtn" class="calc-mode-btn active" style="flex: 1; padding: 12px; border: 2px solid #3b82f6; background: #3b82f6; color: white; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                                    üìä Par Pourcentage
                                </button>
                                <button onclick="switchCalcMode('reps')" id="repsModeBtn" class="calc-mode-btn" style="flex: 1; padding: 12px; border: 2px solid #d1d5db; background: white; color: #6b7280; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                                    üî¢ Par R√©p√©titions
                                </button>
                            </div>
                        </div>

                        <!-- Mode Pourcentage -->
                        <div id="percentageMode" style="display: block;">
                            <div class="form-group">
                                <label class="form-label" style="font-weight: 600; display: block; margin-bottom: 8px;">
                                    Pourcentage du max
                                </label>
                                <div style="display: flex; gap: 12px; align-items: center;">
                                    <input type="range" id="percentageSlider" min="30" max="100" value="75" step="5" 
                                        oninput="updatePercentageCalc()" 
                                        style="flex: 1; height: 8px; border-radius: 4px; background: #e5e7eb; outline: none; -webkit-appearance: none; appearance: none;">
                                    <input type="number" id="percentageInput" min="30" max="100" value="75" 
                                        oninput="updatePercentageCalc()" 
                                        style="width: 80px; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 8px; text-align: center; font-weight: 600; font-size: 16px;">
                                    <span style="font-weight: 600; color: #6b7280;">%</span>
                                </div>
                            </div>

                            <div id="percentageResult" style="display: none; background: #dcfce7; border-left: 4px solid #10b981; padding: 16px; border-radius: 8px; margin-top: var(--space-16);">
                                <div style="font-size: 13px; color: #065f46; font-weight: 600; margin-bottom: 4px;">Charge √† utiliser :</div>
                                <div id="percentageResultValue" style="font-size: 32px; font-weight: 700; color: #047857;">--</div>
                                <div style="font-size: 12px; color: #059669; margin-top: 8px;" id="percentageFormula">--</div>
                            </div>
                        </div>

                        <!-- Mode R√©p√©titions -->
                        <div id="repsMode" style="display: none;">
                            <div class="form-group">
                                <label class="form-label" style="font-weight: 600; display: block; margin-bottom: 8px;">
                                    Nombre de r√©p√©titions cibles
                                </label>
                                <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                    <button onclick="selectReps(3)" class="reps-btn" style="padding: 12px 20px; border: 2px solid #d1d5db; background: white; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;">3</button>
                                    <button onclick="selectReps(5)" class="reps-btn" style="padding: 12px 20px; border: 2px solid #d1d5db; background: white; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;">5</button>
                                    <button onclick="selectReps(8)" class="reps-btn" style="padding: 12px 20px; border: 2px solid #d1d5db; background: white; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;">8</button>
                                    <button onclick="selectReps(10)" class="reps-btn" style="padding: 12px 20px; border: 2px solid #d1d5db; background: white; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;">10</button>
                                    <button onclick="selectReps(12)" class="reps-btn" style="padding: 12px 20px; border: 2px solid #d1d5db; background: white; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;">12</button>
                                    <input type="number" id="customReps" placeholder="Autre" min="1" max="30" 
                                        oninput="selectReps(this.value)"
                                        style="width: 100px; padding: 12px; border: 2px solid #d1d5db; border-radius: 8px; text-align: center; font-weight: 600;">
                                </div>
                            </div>

                            <div id="repsResult" style="display: none; background: #fef3c7; border-left: 4px solid #f59e0b; padding: 16px; border-radius: 8px; margin-top: var(--space-16);">
                                <div style="font-size: 13px; color: #92400e; font-weight: 600; margin-bottom: 4px;">Charge recommand√©e :</div>
                                <div id="repsResultValue" style="font-size: 32px; font-weight: 700; color: #b45309;">--</div>
                                <div style="font-size: 12px; color: #d97706; margin-top: 8px;" id="repsFormula">--</div>
                                <div style="font-size: 12px; color: #92400e; margin-top: 8px; font-style: italic;" id="repsPercentage">--</div>
                            </div>
                        </div>

                        <!-- Info sur les formules -->
                        <div style="margin-top: var(--space-24); padding: 16px; background: #f1f5f9; border-radius: 8px; font-size: 12px; color: #64748b;">
                            <strong style="color: #334155;">üí° √Ä savoir :</strong><br>
                            ‚Ä¢ <strong>Pourcentage</strong> : Charge = MAX √ó Pourcentage<br>
                            ‚Ä¢ <strong>R√©p√©titions</strong> : Utilise la formule d'Epley invers√©e (1RM = Charge √ó (1 + Reps/30))<br>
                            ‚Ä¢ Pour 1-3 reps : ~90-95% du max<br>
                            ‚Ä¢ Pour 5-8 reps : ~75-85% du max<br>
                            ‚Ä¢ Pour 10-12 reps : ~65-75% du max
                        </div>
                    </div>
                </div>
            </div>

            <!-- Matchs Tab -->
            <div id="matchsTab" class="tab-content">
                <div class="card">
                    <h2 class="card-title">‚öΩ Matchs & P√¥le TV</h2>
                    <p style="color: var(--color-text-secondary); margin-bottom: var(--space-24);">
                        D√©clarez vos matchs et suivez les lives du P√¥le TV Sabl√©
                    </p>

                    <!-- D√©clarer mon match -->
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: var(--space-24); margin-bottom: var(--space-16); cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;" 
                         onclick="openMatchDeclaration()"
                         onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px rgba(102, 126, 234, 0.4)';"
                         onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                        <div style="display: flex; align-items: center; gap: var(--space-16);">
                            <div style="font-size: 48px;">üèê</div>
                            <div style="flex: 1;">
                                <h3 style="font-size: 20px; font-weight: 700; color: white; margin-bottom: 8px;">
                                    D√©clarer mon match du Week-end
                                </h3>
                                <p style="color: rgba(255, 255, 255, 0.9); font-size: 14px; margin: 0;">
                                    Renseignez les informations de votre prochain match
                                </p>
                            </div>
                            <div style="font-size: 24px; color: white;">‚Üí</div>
                        </div>
                    </div>

                    <!-- P√¥le TV Sabl√© -->
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 12px; padding: var(--space-24); margin-bottom: var(--space-16); cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;" 
                         onclick="window.open('https://interface-match-en-live.web.app/lives-weekend.html', '_blank')"
                         onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px rgba(245, 87, 108, 0.4)';"
                         onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                        <div style="display: flex; align-items: center; gap: var(--space-16);">
                            <div style="font-size: 48px;">üì∫</div>
                            <div style="flex: 1;">
                                <h3 style="font-size: 20px; font-weight: 700; color: white; margin-bottom: 8px;">
                                    P√¥le TV Sabl√©
                                </h3>
                                <p style="color: rgba(255, 255, 255, 0.9); font-size: 14px; margin: 0;">
                                    Suivez les matchs en direct sur notre plateforme TV
                                </p>
                            </div>
                            <div style="font-size: 24px; color: white;">‚Üí</div>
                        </div>
                    </div>

                    <!-- Partager le lien TV P√¥le Sabl√© -->
                    <div style="background: white; border: 2px solid #e5e7eb; border-radius: 12px; padding: var(--space-24);">
                        <div style="display: flex; align-items: center; gap: var(--space-16); margin-bottom: var(--space-16);">
                            <div style="font-size: 32px;">üì§</div>
                            <div style="flex: 1;">
                                <h3 style="font-size: 18px; font-weight: 600; color: #1f2937; margin-bottom: 4px;">
                                    Partager le lien P√¥le TV
                                </h3>
                                <p style="color: #6b7280; font-size: 13px; margin: 0;">
                                    Partagez le lien avec vos proches pour qu'ils suivent les matchs
                                </p>
                            </div>
                        </div>

                        <div style="background: #f8fafc; border-radius: 8px; padding: 12px 16px; display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                            <input type="text" 
                                   id="tvLinkInput" 
                                   value="https://interface-match-en-live.web.app/lives-weekend.html" 
                                   readonly 
                                   style="flex: 1; border: none; background: transparent; font-size: 14px; color: #1f2937; font-family: monospace; outline: none;">
                            <button onclick="copyTVLink()" 
                                    id="copyTVLinkBtn"
                                    style="padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 13px; cursor: pointer; transition: background 0.2s; white-space: nowrap;"
                                    onmouseover="this.style.background='#2563eb';"
                                    onmouseout="this.style.background='#3b82f6';">
                                üìã Copier
                            </button>
                        </div>

                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <button onclick="shareTVLinkWhatsApp()" 
                                    style="flex: 1; min-width: 150px; padding: 10px 16px; background: #25D366; color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 13px; cursor: pointer; transition: opacity 0.2s;"
                                    onmouseover="this.style.opacity='0.9';"
                                    onmouseout="this.style.opacity='1';">
                                üí¨ WhatsApp
                            </button>
                            <button onclick="shareTVLinkEmail()" 
                                    style="flex: 1; min-width: 150px; padding: 10px 16px; background: #ea4335; color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 13px; cursor: pointer; transition: opacity 0.2s;"
                                    onmouseover="this.style.opacity='0.9';"
                                    onmouseout="this.style.opacity='1';">
                                ‚úâÔ∏è Email
                            </button>
                            <button onclick="shareTVLinkSMS()" 
                                    style="flex: 1; min-width: 150px; padding: 10px 16px; background: #0088cc; color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 13px; cursor: pointer; transition: opacity 0.2s;"
                                    onmouseover="this.style.opacity='0.9';"
                                    onmouseout="this.style.opacity='1';">
                                üí¨ SMS
                            </button>
                        </div>

                        <div id="copySuccessMessage" 
                             style="display: none; margin-top: 12px; padding: 12px; background: #dcfce7; border-left: 4px solid #10b981; border-radius: 6px; color: #065f46; font-size: 13px; font-weight: 600;">
                            ‚úÖ Lien copi√© dans le presse-papier !
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Coach Dashboard -->
    <div id="coachScreen" class="screen">
        <div class="header">
            <div class="container">
                <div class="header-content">
                    <div>
                        <h1 class="header-title">Dashboard Coach</h1>
                        <p class="header-subtitle">Vue d'ensemble de l'√©quipe</p>
                    </div>
                    <div style="display: flex; gap: var(--space-12);">
                        <button class="btn btn-primary" onclick="openAddPlayerModal()">+ Ajouter une joueuse</button>
                        <button class="btn logout-btn" onclick="logout()">D√©connexion</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Zone de notifications pour le dashboard coach -->
        <div class="container">
            <div id="coachNotificationsContainer" style="margin-top: 20px;"></div>
        </div>
        
        <div class="container dashboard">
            <!-- Onglets -->
            <div class="tabs" style="margin-bottom: var(--space-24); border-bottom: 2px solid var(--color-border); overflow-x: auto; white-space: nowrap;">
                <button class="tab-btn active" onclick="switchCoachTab('team')" data-tab="team" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px;">
                    üë• √âquipe
                </button>
                <button class="tab-btn" onclick="switchCoachTab('weekend')" data-tab="weekend" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px; color: var(--color-text-secondary);">
                    üèê Matchs Week-end
                </button>
                <button class="tab-btn" onclick="switchCoachTab('reports')" data-tab="reports" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px; color: var(--color-text-secondary);">
                    üìä Rapports
                </button>
                <button class="tab-btn" onclick="switchCoachTab('injuries')" data-tab="injuries" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px; color: var(--color-text-secondary);">
                    üè• Blessures
                </button>
                <button class="tab-btn" onclick="switchCoachTab('messages')" data-tab="messages" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px; color: var(--color-text-secondary);">
                    üì¢ Messages
                </button>
                <button class="tab-btn" onclick="switchCoachTab('restPeriods')" data-tab="restPeriods" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px; color: var(--color-text-secondary);">
                    ‚è∏Ô∏è P√©riodes de Repos
                </button>
                <button class="tab-btn" onclick="switchCoachTab('physicalPrep')" data-tab="physicalPrep" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px; color: var(--color-text-secondary);">
                    üí™ Pr√©pa Physique
                </button>
                <button class="tab-btn" onclick="switchCoachTab('management')" data-tab="management" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px; color: var(--color-text-secondary);">
                    ‚öôÔ∏è Gestion √âquipe
                </button>
                <button class="tab-btn" onclick="switchCoachTab('engagement')" data-tab="engagement" style="padding: var(--space-12) var(--space-24); border: none; background: none; cursor: pointer; font-weight: var(--font-weight-medium); border-bottom: 3px solid transparent; margin-bottom: -2px; color: var(--color-text-secondary);">
                    üî• Engagement
                </button>
            </div>

            <!-- Onglet √âquipe -->
            <div id="teamTab" class="coach-tab-content">
            <!-- Filtres par Statut -->
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all" onclick="filterPlayers('all')">
                    üë• Toutes (<span id="countAll">0</span>)
                </button>
                <button class="filter-btn optimal" data-filter="optimal" onclick="filterPlayers('optimal')">
                    ‚úÖ Optimal (<span id="countOptimal">0</span>)
                </button>
                <button class="filter-btn attention" data-filter="attention" onclick="filterPlayers('attention')">
                    ‚ö†Ô∏è Attention (<span id="countAttention">0</span>)
                </button>
                <button class="filter-btn critical" data-filter="critical" onclick="filterPlayers('critical')">
                    üö® Critique (<span id="countCritical">0</span>)
                </button>
            </div>

            <!-- Liste des joueuses -->
            <div id="teamGrid" class="team-grid">
                <!-- Les cartes des joueuses seront g√©n√©r√©es ici -->
            </div>

            <!-- Bouton Mise √† jour + Graphiques Coach -->
            <div style="margin-top: 40px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0; color: #1f2937;">üìä Statistiques d'entra√Ænement</h2>
                <button id="refreshChartsBtn" onclick="refreshCoachCharts()" style="
                    background: #667eea;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 8px;
                    cursor: pointer;
                    font-size: 14px;
                    font-weight: 500;
                    transition: all 0.2s;
                " onmouseover="this.style.background='#5a67d8'" onmouseout="this.style.background='#667eea'">
                    üîÑ Mettre √† jour
                </button>
            </div>

            <!-- Graphique Charge d'Entra√Ænement Semaine Coach -->
            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px;">
                <h3 style="margin-top: 0;">üìä Volume Hebdomadaire par Joueuse</h3>
                <p style="color: #666; font-size: 14px; margin-bottom: 20px;">Moyenne hebdomadaire sur les 2 derni√®res semaines vs moyenne √©quipe</p>
                <div style="height: 400px;">
                    <canvas id="coachWeeklyChart"></canvas>
                </div>
            </div>

            <!-- Graphique Charge d'Entra√Ænement Mois Coach -->
            <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                <h3 style="margin-top: 0;">üìÖ Volume Mensuel par Joueuse</h3>
                <p style="color: #666; font-size: 14px; margin-bottom: 20px;">Heures du mois en cours vs moyenne √©quipe</p>
                <div style="height: 400px;">
                    <canvas id="coachMonthlyChart"></canvas>
                </div>
            </div>

            <!-- Graphique Cumul Annuel Coach -->
            <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                <h3 style="margin-top: 0;">üéØ Cumul Annuel par Joueuse</h3>
                <p style="color: #666; font-size: 14px; margin-bottom: 20px;">Progression vers l'objectif de 720h par joueuse</p>
                <div style="height: 500px;">
                    <canvas id="coachAnnualChart"></canvas>
                </div>
            </div>
            </div>

            <!-- Onglet Matchs Week-end -->
            <div id="weekendTab" class="coach-tab-content" style="display: none;">
                <div id="weekendMatchRecap">
                    <!-- Le r√©cap sera g√©n√©r√© ici -->
                </div>
            </div>

            <!-- Onglet Rapports -->
            <div id="reportsTab" class="coach-tab-content" style="display: none;">
                <!-- Bouton Export PDF -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-24);">
                    <h2 style="font-size: var(--font-size-2xl); font-weight: var(--font-weight-bold); margin: 0;">üìä Rapports &amp; Analyses</h2>
                    <button id="btnExportPDF" onclick="exportTeamReportPDF()" class="btn-export-pdf">üìÑ Exporter PDF</button>
                </div>
                <div class="card" style="margin-bottom: var(--space-24);">
                    <h3 class="card-title">üìä √âvolution √©quipe (7 jours)</h3>
                    <canvas id="teamEvolutionChart" style="max-height: 300px;"></canvas>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-24); margin-bottom: var(--space-24);">
                    <div class="card">
                        <h3 class="card-title">üèãÔ∏è Distribution de charge</h3>
                        <canvas id="loadDistributionChart" style="max-height: 250px;"></canvas>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title">‚ö° TSB Moyen de l'√©quipe</h3>
                        <div style="text-align: center; padding: var(--space-32);">
                            <div style="font-size: 48px; font-weight: var(--font-weight-bold); color: var(--color-primary);" id="avgTSB">--</div>
                            <div style="margin-top: var(--space-8); color: var(--color-text-secondary);">Training Stress Balance</div>
                            <div style="margin-top: var(--space-16); padding: var(--space-16); background: var(--color-background); border-radius: var(--radius-base);" id="tsbInterpretation">
                                <strong>Interpr√©tation :</strong> <span id="tsbText">En attente de donn√©es...</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="card-title">üìù R√©sum√© de l'√©quipe</h3>
                    <div id="teamSummary" style="line-height: 1.8;">
                        <p><strong>Joueuses actives :</strong> <span id="activePlayers">--</span></p>
                        <p><strong>Check-ins aujourd'hui :</strong> <span id="todayCheckins">--</span></p>
                        <p><strong>Score moyen de l'√©quipe :</strong> <span id="avgTeamScore">--</span>/10</p>
                        <p><strong>Charge moyenne (7 jours) :</strong> <span id="avgLoad7days">--</span></p>
                    </div>
                </div>
            </div>

            <!-- Onglet Blessures -->
            <div id="injuriesTab" class="coach-tab-content" style="display: none;">
                <!-- En-t√™te avec bouton nouvelle blessure -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-24);">
                    <h2 style="font-size: var(--font-size-2xl); font-weight: var(--font-weight-bold); margin: 0;">Suivi des Blessures</h2>
                    <button id="btnNewInjury" class="btn btn-primary">
                        + D√©clarer une blessure
                    </button>
                </div>

                <!-- Statistiques -->
                <div class="metrics-grid" style="margin-bottom: var(--space-24);">
                    <div class="metric-card">
                        <div class="metric-value" id="activeInjuriesCount" style="color: var(--danger-color);">0</div>
                        <div class="metric-label">Blessures actives</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="totalInjuriesCount">0</div>
                        <div class="metric-label">Total blessures</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="avgRecoveryDays">-- jours</div>
                        <div class="metric-label">Dur√©e moyenne d'indisponibilit√©</div>
                    </div>
                </div>

                <!-- Cartes d'information -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-24); margin-bottom: var(--space-24);">
                    <div class="card">
                        <h3 class="card-title">üö® Blessures en cours</h3>
                        <div id="activeInjuriesList">
                            <p style="color: #666; font-style: italic;">Aucune blessure active</p>
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-title">üìä R√©partition par type</h3>
                        <div id="injuryTypeDistribution">
                            <p style="color: #666; font-style: italic;">Aucune donn√©e disponible</p>
                        </div>
                    </div>
                </div>

                <!-- ============================================== -->
                <!-- SECTION DOULEURS (Sans arr√™t de jeu) -->
                <!-- ============================================== -->
                <div style="background: linear-gradient(135deg, #FFE4B5 0%, #FFD09B 100%); padding: var(--space-24); border-radius: var(--radius-lg); margin-bottom: var(--space-24); color: #333;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-16);">
                        <h3 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-bold); margin: 0;">
                            ‚ö†Ô∏è Douleurs √† surveiller
                        </h3>
                        <div class="metric-value" id="activePainsCount" style="color: #8B4513; background: rgba(255,255,255,0.6); padding: var(--space-8) var(--space-16); border-radius: var(--radius-full); font-size: var(--font-size-lg);">0</div>
                    </div>
                    <p style="opacity: 0.95; margin-bottom: var(--space-16); font-size: var(--font-size-sm);">
                        Les douleurs permettent de suivre les g√™nes des joueuses qui peuvent continuer √† jouer mais n√©cessitent une surveillance. 
                        Diff√©rentes des blessures qui arr√™tent compl√®tement l'activit√©.
                    </p>
                    
                    <!-- Formulaire de d√©claration de douleur -->
                    <div style="background: rgba(255,255,255,0.5); padding: var(--space-20); border-radius: var(--radius-base); margin-bottom: var(--space-16);">
                        <h4 style="margin: 0 0 var(--space-16) 0; font-weight: var(--font-weight-semibold);">‚ûï D√©clarer une douleur</h4>
                        <form id="declarePainForm" onsubmit="event.preventDefault(); declarePain();">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-12); margin-bottom: var(--space-12);">
                                <div>
                                    <label style="display: block; margin-bottom: var(--space-4); font-weight: var(--font-weight-medium);">Joueuse</label>
                                    <select id="painPlayerSelect" required style="width: 100%; padding: var(--space-8); border-radius: var(--radius-base); border: none;">
                                        <option value="">S√©lectionner...</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: var(--space-4); font-weight: var(--font-weight-medium);">Zone corporelle</label>
                                    <select id="painBodyZone" required style="width: 100%; padding: var(--space-8); border-radius: var(--radius-base); border: none;">
                                        <option value="">S√©lectionner...</option>
                                        <option value="head">T√™te</option>
                                        <option value="neck">Cou</option>
                                        <option value="shoulder">√âpaule</option>
                                        <option value="elbow">Coude</option>
                                        <option value="wrist">Poignet</option>
                                        <option value="hand">Main/Doigts</option>
                                        <option value="back">Dos</option>
                                        <option value="lower_back">Bas du dos</option>
                                        <option value="hip">Hanche</option>
                                        <option value="thigh">Cuisse</option>
                                        <option value="knee">Genou</option>
                                        <option value="calf">Mollet</option>
                                        <option value="ankle">Cheville</option>
                                        <option value="foot">Pied</option>
                                    </select>
                                </div>
                            </div>
                            <div style="margin-bottom: var(--space-12);">
                                <label style="display: block; margin-bottom: var(--space-4); font-weight: var(--font-weight-medium);">Description (optionnel)</label>
                                <input type="text" id="painDescription" placeholder="Ex: L√©ger point au poignet lors des frappes" style="width: 100%; padding: var(--space-8); border-radius: var(--radius-base); border: none;" maxlength="100" />
                            </div>
                            <button type="submit" class="btn" style="background: white; color: #D2691E; font-weight: var(--font-weight-semibold); padding: var(--space-10) var(--space-20); border: none; border-radius: var(--radius-base); cursor: pointer;">
                                ‚úÖ D√©clarer la douleur
                            </button>
                        </form>
                    </div>
                    
                    <!-- Tableau des douleurs actives -->
                    <div style="background: white; color: #1f2937; padding: var(--space-16); border-radius: var(--radius-base);">
                        <h4 style="margin: 0 0 var(--space-12) 0; font-weight: var(--font-weight-semibold);">Douleurs actives</h4>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; font-size: var(--font-size-sm);">
                                <thead>
                                    <tr style="border-bottom: 2px solid #e5e7eb;">
                                        <th style="padding: var(--space-8); text-align: left;">Joueuse</th>
                                        <th style="padding: var(--space-8); text-align: left;">Date</th>
                                        <th style="padding: var(--space-8); text-align: left;">Zone</th>
                                        <th style="padding: var(--space-8); text-align: left;">Description</th>
                                        <th style="padding: var(--space-8); text-align: left;">Dur√©e</th>
                                        <th style="padding: var(--space-8); text-align: center;">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="painsTableBody">
                                    <tr>
                                        <td colspan="6" style="text-align: center; padding: var(--space-20); color: #666;">
                                            Aucune douleur signal√©e
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Filtres -->

                <div style="display: flex; gap: var(--space-12); margin-bottom: var(--space-16);">
                    <button class="injury-filter-btn active" data-filter="active" style="padding: var(--space-8) var(--space-16); border: 1px solid var(--color-border); background: var(--color-primary); color: white; border-radius: var(--radius-base); cursor: pointer; font-weight: var(--font-weight-medium);">
                        Actives
                    </button>
                    <button class="injury-filter-btn" data-filter="all" style="padding: var(--space-8) var(--space-16); border: 1px solid var(--color-border); background: white; color: var(--color-text); border-radius: var(--radius-base); cursor: pointer; font-weight: var(--font-weight-medium);">
                        Toutes
                    </button>
                </div>

                <!-- Tableau des blessures -->
                <div class="card">
                    <h3 class="card-title">Historique des blessures</h3>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="border-bottom: 2px solid var(--color-border); text-align: left;">
                                    <th style="padding: var(--space-12); font-weight: var(--font-weight-bold);">Joueuse</th>
                                    <th style="padding: var(--space-12); font-weight: var(--font-weight-bold);">Date</th>
                                    <th style="padding: var(--space-12); font-weight: var(--font-weight-bold);">Type</th>
                                    <th style="padding: var(--space-12); font-weight: var(--font-weight-bold);">Zone</th>
                                    <th style="padding: var(--space-12); font-weight: var(--font-weight-bold);">Gravit√©</th>
                                    <th style="padding: var(--space-12); font-weight: var(--font-weight-bold);">Statut</th>
                                    <th style="padding: var(--space-12); font-weight: var(--font-weight-bold);">Dur√©e</th>
                                    <th style="padding: var(--space-12); font-weight: var(--font-weight-bold);">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="injuriesTableBody">
                                <tr>
                                    <td colspan="8" style="text-align: center; padding: 40px; color: #666;">
                                        Aucune blessure enregistr√©e
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Onglet Messages Urgents -->
            <div id="messagesTab" class="coach-tab-content" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                    <h2 style="margin: 0; font-size: 28px; color: #1a1a1a;">üì¢ Messages Urgents</h2>
                    <button onclick="openUrgentMessageModal()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 24px; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
                        ‚ûï Nouveau Message
                    </button>
                </div>
                
                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.08);">
                    <h3 style="margin: 0 0 20px 0; font-size: 20px; color: #1a1a1a;">Messages Programm√©s</h3>
                    
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa; border-bottom: 2px solid #e0e0e0;">
                                <th style="padding: 12px; text-align: left; font-weight: 600; color: #555;">Date</th>
                                <th style="padding: 12px; text-align: left; font-weight: 600; color: #555;">Message</th>
                                <th style="padding: 12px; text-align: left; font-weight: 600; color: #555;">Destinataires</th>
                                <th style="padding: 12px; text-align: left; font-weight: 600; color: #555;">Priorit√©</th>
                                <th style="padding: 12px; text-align: left; font-weight: 600; color: #555;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="scheduledMessagesTableBody">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 30px; color: #666;">
                                    Chargement...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Onglet P√©riodes de Repos -->
            <div id="restPeriodsTab" class="coach-tab-content" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                    <h2 style="margin: 0; font-size: 28px; color: #1a1a1a;">‚è∏Ô∏è Gestion des P√©riodes de Repos</h2>
                    <button onclick="openRestPeriodModal()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 24px; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
                        ‚ûï Nouvelle P√©riode
                    </button>
                </div>

                <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.08);">
                    <table id="restPeriodsTable" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <th style="padding: 15px; text-align: left; border-radius: 8px 0 0 0;">Type</th>
                                <th style="padding: 15px; text-align: left;">P√©riode</th>
                                <th style="padding: 15px; text-align: left;">Week-ends</th>
                                <th style="padding: 15px; text-align: left;">Message</th>
                                <th style="padding: 15px; text-align: center; border-radius: 0 8px 0 0;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="restPeriodsTableBody">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 30px; color: #666;">
                                    Chargement...
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <div id="noRestPeriodsMessage" style="text-align: center; padding: 40px; color: #95a5a6; font-size: 16px; display: none;">
                        Aucune p√©riode de repos d√©finie. Cliquez sur "Nouvelle P√©riode" pour en cr√©er une.
                    </div>
                </div>
            </div>
            
            <!-- Onglet Planificateur Semaine -->
            <div id="weekPlannerTab" class="coach-tab-content" style="display: none;">
                <div id="weekPlannerContainer">
                    <div style="text-align: center; padding: 40px;">
                        <div class="spinner"></div>
                        <p style="margin-top: 16px; color: var(--color-text-secondary);">Chargement du planificateur...</p>
                    </div>
                </div>
            </div>

            <!-- Onglet Planning Avanc√© (Netflix Style) - Int√©gration React -->
            <div id="teamPlannerTab" class="coach-tab-content" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 9999; background: #141414;">
                <!-- Bouton de retour -->
                <button 
                    onclick="switchCoachTab('team')" 
                    style="position: fixed; top: 16px; right: 16px; z-index: 10000; background: rgba(0,0,0,0.8); color: white; border: 2px solid #E50914; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 16px; backdrop-filter: blur(10px); transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;"
                    onmouseover="this.style.background='#E50914'; this.style.transform='scale(1.05)';"
                    onmouseout="this.style.background='rgba(0,0,0,0.8)'; this.style.transform='scale(1)';"
                    title="Retour au dashboard"
                >
                    <span style="font-size: 20px;">‚Üê</span>
                    Retour
                </button>
                
                <div style="position: relative; width: 100%; height: 100%;">
                    <!-- Iframe vers l'application React Team Planner -->
                    <iframe 
                        id="teamPlannerIframe"
                        src="about:blank" 
                        style="width: 100%; height: 100%; border: none; background: #141414;"
                        title="RPE Team Planner"
                    ></iframe>
                    
                    <!-- Fallback si l'iframe ne charge pas -->
                    <div id="teamPlannerFallback" style="display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: #141414; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; padding: 40px;">
                        <div style="font-size: 64px; margin-bottom: 24px;">üé¨</div>
                        <h2 style="color: #E50914; font-size: 28px; font-weight: 700; margin-bottom: 16px;">RPE Team Planner</h2>
                        <p style="color: #888; font-size: 16px; max-width: 500px; line-height: 1.6;">
                            Pour un d√©veloppement plus rapide avec hot-reload, vous pouvez lancer le serveur dev :<br><br>
                        </p>
                        <code style="background: #333; padding: 16px 24px; border-radius: 8px; font-family: monospace; margin-top: 16px; color: #10B981;">
                            cd "projet Manus" && npm run dev
                        </code>
                        <p style="color: #666; font-size: 14px; margin-top: 24px;">
                            Sinon, le Planning Avanc√© est d√©j√† int√©gr√© et fonctionnel ! üéâ
                        </p>
                    </div>
                </div>
            </div>

            <!-- Onglet Pr√©pa Physique -->
            <div id="physicalPrepTab" class="coach-tab-content" style="display: none;">
                <div class="card">
                    <div style="margin-bottom: var(--space-24);">
                        <h2 style="font-size: var(--font-size-2xl); font-weight: var(--font-weight-bold); color: var(--color-text);">üí™ Pr√©paration Physique</h2>
                        <p style="color: var(--color-text-secondary); margin-top: var(--space-4);">G√©rez les tests physiques et leur √©volution</p>
                    </div>

                    <!-- Section Export Excel -->
                    <div style="background: linear-gradient(135deg, #4ECDC4 0%, #44A08D 100%); padding: var(--space-24); border-radius: var(--radius-lg); margin-bottom: var(--space-24); color: white;">
                        <h3 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-bold); margin-bottom: var(--space-12); display: flex; align-items: center; gap: var(--space-8);">
                            üì• 1. T√©l√©charger le mod√®le Excel
                        </h3>
                        <p style="margin-bottom: var(--space-16); opacity: 0.9;">
                            G√©n√©rez un fichier Excel pr√©-rempli avec les noms de toutes les joueuses de votre √©quipe. Remplissez les donn√©es de tests et r√©importez-le ensuite.
                        </p>
                        <div style="display: flex; gap: var(--space-12); align-items: center;">
                            <button class="btn" onclick="exportTestsTemplate()" style="background: white; color: #44A08D; font-weight: var(--font-weight-semibold); padding: var(--space-12) var(--space-24); border: none; border-radius: var(--radius-base); cursor: pointer; display: flex; align-items: center; gap: var(--space-8);">
                                <span style="font-size: 20px;">üìä</span>
                                G√©n√©rer le mod√®le Excel
                            </button>
                            <div style="background: rgba(255,255,255,0.2); padding: var(--space-8) var(--space-16); border-radius: var(--radius-base); font-size: var(--font-size-sm);">
                                <strong id="playerCountLabel">-</strong> joueuses
                            </div>
                        </div>
                    </div>

                    <!-- Section Import Excel -->
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: var(--space-24); border-radius: var(--radius-lg); margin-bottom: var(--space-24); color: white;">
                        <h3 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-bold); margin-bottom: var(--space-12); display: flex; align-items: center; gap: var(--space-8);">
                            üì§ 2. Importer les donn√©es de tests
                        </h3>
                        <p style="margin-bottom: var(--space-16); opacity: 0.9;">
                            Une fois le fichier Excel rempli avec les donn√©es de tests, importez-le ici. Chaque import cr√©e une nouvelle session de tests dat√©e.
                        </p>
                        <div style="display: flex; gap: var(--space-12); align-items: flex-start; flex-direction: column;">
                            <div style="display: flex; gap: var(--space-12); align-items: center; width: 100%;">
                                <input type="date" id="testDateInput" class="form-control" style="max-width: 200px; background: white; border: 2px solid rgba(255,255,255,0.5); color: #333;" />
                                <input type="file" id="testFileInput" accept=".csv,.xlsx,.xls" class="form-control" style="flex: 1; background: white; border: 2px solid rgba(255,255,255,0.5); color: #333;" />
                                <button class="btn" onclick="importTestsFile()" style="background: white; color: #764ba2; font-weight: var(--font-weight-semibold); padding: var(--space-12) var(--space-24); border: none; border-radius: var(--radius-base); cursor: pointer; white-space: nowrap;">
                                    üì• Importer
                                </button>
                            </div>
                            <div style="background: rgba(255,255,255,0.2); padding: var(--space-12); border-radius: var(--radius-base); font-size: var(--font-size-sm); width: 100%;">
                                <strong>üí° Format attendu :</strong> Fichier CSV ou Excel avec une colonne "Joueuse" et les colonnes de tests (Taille, Poids, DC Max, Saut √âlan, etc.)
                            </div>
                        </div>
                    </div>

                    <!-- Historique des imports -->
                    <div style="background: var(--color-surface); padding: var(--space-24); border-radius: var(--radius-lg); border: 1px solid var(--color-border);">
                        <h3 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-bold); margin-bottom: var(--space-16); color: var(--color-text);">
                            üìä Sessions de tests enregistr√©es
                        </h3>
                        <div id="testSessionsList">
                            <div style="text-align: center; padding: 40px; color: var(--color-text-secondary);">
                                <div style="font-size: 48px; margin-bottom: 16px;">üìã</div>
                                <p>Aucune session de tests enregistr√©e</p>
                                <p style="font-size: var(--font-size-sm); margin-top: 8px;">Importez un fichier pour cr√©er votre premi√®re session</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Onglet Gestion √âquipe -->
            <div id="managementTab" class="coach-tab-content" style="display: none;">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-24);">
                        <div>
                            <h2 style="font-size: var(--font-size-2xl); font-weight: var(--font-weight-bold); color: var(--color-text);">üë• Gestion des Joueuses</h2>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-4);">Modifiez les informations des joueuses de l'√©quipe</p>
                        </div>
                        <div style="display: flex; gap: var(--space-12); align-items: center;">
                            <!-- Toggle vue Cartes / Tableau -->
                            <div style="display: flex; background: #f3f4f6; border-radius: var(--radius-base); padding: 4px;">
                                <button id="viewCardsBtn" class="view-toggle-btn active" data-view="cards" style="padding: 8px 16px; border: none; background: white; border-radius: var(--radius-base); cursor: pointer; font-size: var(--font-size-sm); font-weight: var(--font-weight-medium); transition: all var(--duration-fast);">
                                    üÉè Cartes
                                </button>
                                <button id="viewTableBtn" class="view-toggle-btn" data-view="table" style="padding: 8px 16px; border: none; background: transparent; border-radius: var(--radius-base); cursor: pointer; font-size: var(--font-size-sm); font-weight: var(--font-weight-medium); color: var(--color-text-secondary); transition: all var(--duration-fast);">
                                    üìä Tableau
                                </button>
                            </div>
                            <button class="btn btn-primary" onclick="openAddPlayerModal()">+ Ajouter une joueuse</button>
                        </div>
                    </div>

                    <!-- Barre de recherche -->
                    <div class="form-group">
                        <input type="text" class="form-control" id="searchPlayerInput" placeholder="üîç Rechercher une joueuse..." onkeyup="filterPlayersManagement()">
                    </div>

                    <!-- Vue Cartes -->
                    <div id="playersManagementList" style="margin-top: var(--space-24);">
                        <div style="text-align: center; padding: 40px;">
                            <div class="spinner"></div>
                            <p style="margin-top: 16px; color: var(--color-text-secondary);">Chargement de la liste...</p>
                        </div>
                    </div>

                    <!-- Vue Tableau Excel -->
                    <div id="playersTableView" style="display: none; margin-top: var(--space-24);">
                        <div style="background: #fef3c7; padding: var(--space-12); border-radius: var(--radius-base); margin-bottom: var(--space-16); display: flex; align-items: center; gap: var(--space-12);">
                            <span style="font-size: 20px;">üí°</span>
                            <div style="flex: 1;">
                                <p style="font-weight: var(--font-weight-medium); margin-bottom: 4px;">Saisie rapide</p>
                                <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Cliquez sur une cellule pour la modifier. Les modifications sont automatiquement sauvegard√©es.</p>
                            </div>
                        </div>
                        
                        <div style="overflow-x: auto; border: 1px solid var(--color-border); border-radius: var(--radius-base); max-height: 70vh;">
                            <table id="playersTable" style="width: auto; border-collapse: collapse; background: white; font-size: 10px;">
                                <thead style="background: #f9fafb; position: sticky; top: 0; z-index: 10;">
                                    <tr>
                                        <th colspan="6" style="padding: 8px; border: 1px solid #333; background: #e5e7eb; text-align: center; font-weight: bold;">INFOS PERSONNELLES</th>
                                        <th colspan="10" style="padding: 8px; border: 1px solid #333; background: #dbeafe; text-align: center; font-weight: bold;">ANTHROPO</th>
                                        <th colspan="7" style="padding: 8px; border: 1px solid #333; background: #fef3c7; text-align: center; font-weight: bold;">TEST VOLLEY</th>
                                        <th colspan="30" style="padding: 8px; border: 1px solid #333; background: #fee2e2; text-align: center; font-weight: bold;">TEST MUSCU</th>
                                        <th colspan="3" style="padding: 8px; border: 1px solid #333; background: #dcfce7; text-align: center; font-weight: bold;">TEST PHYSIO</th>
                                        <th rowspan="2" style="padding: 8px; border: 1px solid #333; text-align: center; position: sticky; right: 0; background: #f9fafb; z-index: 11;">ACTIONS</th>
                                    </tr>
                                    <tr>
                                        <!-- INFOS PERSONNELLES -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; min-width: 120px; position: sticky; left: 0; background: #f9fafb; z-index: 11;">JOUEUSES</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap;">ANCIENNETE<br>EN POLE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; min-width: 100px;">AXE DEVELOPPEMENT<br>PRIORITAIRE EN MUSCU</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap;">DATE DE<br>NAISSANCE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap;">LATERALITE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap;">POSTE</th>
                                        
                                        <!-- ANTHROPO -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">TAILLE<br>(cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">POIDS<br>(kg)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">LONGUEUR<br>MEMBRE INF<br>(cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">TAILLE<br>ASSISE<br>(cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">ENVERGURE<br>(cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">% MASSE<br>GRASSE<br>(%)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">HAUTEUR<br>1B (cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">HAUTEUR<br>2B (cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">GRIP G</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dbeafe;">GRIP D</th>
                                        
                                        <!-- TEST VOLLEY -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fef3c7;">SAUT AVEC<br>ELAN (cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fef3c7;">SAUT SANS<br>ELAN (cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fef3c7;">BROAD JUMP<br>(2 JAMBES) (cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fef3c7;">LANCER MB<br>CAV (cm)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fef3c7;">LANCER MB<br>GAUCHE DEVANT</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fef3c7;">LANCER MB<br>POITRINE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fef3c7;">LANCER MB<br>DROITE DEVANT</th>
                                        
                                        <!-- TEST MUSCU - Vitesse -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">VITESSE<br>CHRONO<br>3x6m (sec)</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">CHRONO<br>5m d√©part<br>(sec)</th>
                                        
                                        <!-- DC BARRE -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">DC<br>REP</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">DC<br>CHARGE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">DC MAX<br>EXTRAPOLE</th>
                                        
                                        <!-- TRACTION -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">TRACTION<br>REP</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">TRACTION<br>CHARGE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">TRACTION<br>MAX EXTRAP.</th>
                                        
                                        <!-- TIRAGE BANC -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">TIRAGE<br>REP</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">TIRAGE<br>CHARGE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">TIRAGE<br>MAX EXTRAP.</th>
                                        
                                        <!-- PULL OVER -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">PULL OVER<br>REP</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">PULL OVER<br>CHARGE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">PULL OVER<br>MAX EXTRAP.</th>
                                        
                                        <!-- HIP THRUST -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">HIP THRUST<br>REP</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">HIP THRUST<br>CHARGE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">HIP THRUST<br>MAX EXTRAP.</th>
                                        
                                        <!-- SDT (Soulev√© de Terre) -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">SDT<br>REP</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">SDT<br>CHARGE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">SDT<br>MAX EXTRAP.</th>
                                        
                                        <!-- BACK SQUAT -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">BACK SQUAT<br>REP</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">BACK SQUAT<br>CHARGE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">BACK SQUAT<br>MAX EXTRAP.</th>
                                        
                                        <!-- EPAULE -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">EPAULE<br>REP</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">EPAULE<br>CHARGE</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #fee2e2;">EPAULE<br>MAX EXTRAP.</th>
                                        
                                        <!-- TEST PHYSIO -->
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dcfce7;">VMA<br>TEMPS</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dcfce7;">VMA<br>PALIER</th>
                                        <th style="padding: 6px 8px; border: 1px solid #333; white-space: nowrap; background: #dcfce7;">DATE<br>VMA</th>
                                    </tr>
                                </thead>
                                <tbody id="playersTableBody">
                                    <tr>
                                        <td colspan="57" style="padding: 40px; text-align: center; color: var(--color-text-secondary);">
                                            <div class="spinner"></div>
                                            <p style="margin-top: 16px;">Chargement...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Onglet Engagement -->
            <div id="engagementTab" class="coach-tab-content" style="display: none;">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-24);">
                        <div>
                            <h2 style="font-size: var(--font-size-2xl); font-weight: var(--font-weight-bold); color: var(--color-text);">üî• Engagement & Motivation</h2>
                            <p style="color: var(--color-text-secondary); margin-top: var(--space-4);">Suivez l'assiduit√©, les s√©ries et les stickers</p>
                        </div>
                        <div id="fillIndicator" style="font-size: 14px;"></div>
                    </div>
                    
                    <!-- Sous-onglets Engagement -->
                    <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.1);">
                        <button class="engagement-sub-tab active" onclick="switchEngagementSubTab('stats')" data-subtab="stats" style="padding: 12px 24px; background: none; border: none; color: #666; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; margin-bottom: -2px;">
                            üìä Statistiques
                        </button>
                        <button class="engagement-sub-tab" onclick="switchEngagementSubTab('stickers')" data-subtab="stickers" style="padding: 12px 24px; background: none; border: none; color: #666; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; margin-bottom: -2px;">
                            üèÜ Stickers
                        </button>
                        <button class="engagement-sub-tab" onclick="switchEngagementSubTab('maintenance')" data-subtab="maintenance" style="padding: 12px 24px; background: none; border: none; color: #666; font-weight: 600; cursor: pointer; border-bottom: 3px solid transparent; margin-bottom: -2px;">
                            üîß Maintenance
                        </button>
                    </div>
                    
                    <!-- Contenu Stats -->
                    <div id="engagementStatsContent" class="engagement-sub-content">
                        <div id="engagementContent">
                            <p style="text-align: center; color: #666;">Chargement des statistiques...</p>
                            
                            <!-- Graphique d'√©volution de l'√©quipe -->
                            <div class="card" style="margin-top: 20px; padding: 20px;">
                                <h3 class="card-title">üìà √âvolution de l'√âtat de Forme de l'√âquipe (7 derniers jours)</h3>
                                <canvas id="teamEvolutionChart" width="400" height="200"></canvas>
                            </div>

                            <!-- Graphique de distribution de charge -->
                            <div class="card" style="margin-top: 20px; padding: 20px;">
                                <h3 class="card-title">üìä Distribution de la Charge d'Entra√Ænement</h3>
                                <canvas id="loadDistributionChart" width="400" height="200"></canvas>
                            </div>

                            <!-- R√©sum√© de l'√©quipe -->
                            <div class="card" style="margin-top: 20px; padding: 20px;">
                                <h3 class="card-title">üìù R√©sum√© G√©n√©ral de l'√âquipe</h3>
                                <div id="teamSummaryContent">
                                    <p style="text-align: center; color: #666;">Chargement du r√©sum√©...</p>
                                </div>
                            </div>

                        </div>
                    </div>
                    
                    <!-- Contenu Stickers -->
                    <div id="engagementStickersContent" class="engagement-sub-content" style="display: none; max-height: none; overflow: visible;">
                        <div id="coachStickersVerification" style="max-height: none; overflow: visible;">
                            <p style="text-align: center; color: #666;">Chargement des stickers...</p>
                        </div>
                    </div>

                    <!-- Contenu Maintenance -->
                    <div id="engagementMaintenanceContent" class="engagement-sub-content" style="display: none;">
                        <div style="padding: 20px;">
                            <h3 style="margin-bottom: 20px; color: #1f2937;">üîß Outils de Maintenance</h3>
                            <p style="color: #666; margin-bottom: 30px;">
                                Ces outils permettent de recalculer les streaks et restaurer les stickers perdus.
                                <br><strong>Les stickers gagn√©s ne sont jamais supprim√©s</strong>, seulement restaur√©s si manquants.
                            </p>

                            <div style="display: grid; gap: 20px; max-width: 600px;">
                                <!-- Bouton R√©parer N√©lia et Lilou -->
                                <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 20px;">
                                    <h4 style="margin: 0 0 10px 0; color: #92400e;">üéØ R√©parer N√©lia et Lilou</h4>
                                    <p style="color: #78350f; font-size: 14px; margin-bottom: 15px;">
                                        Recalcule les streaks et restaure les stickers manquants pour N√©lia et Lilou uniquement.
                                    </p>
                                    <button onclick="repairNeliaAndLilou()" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 14px;">
                                        üîß R√©parer N√©lia & Lilou
                                    </button>
                                </div>

                                <!-- Bouton Recalculer toutes les joueuses -->
                                <div style="background: #dbeafe; border: 2px solid #3b82f6; border-radius: 12px; padding: 20px;">
                                    <h4 style="margin: 0 0 10px 0; color: #1e40af;">üîÑ Recalculer toutes les joueuses</h4>
                                    <p style="color: #1e3a8a; font-size: 14px; margin-bottom: 15px;">
                                        Recalcule les streaks et stickers pour <strong>toutes</strong> les joueuses.
                                        Cette op√©ration peut prendre quelques secondes.
                                    </p>
                                    <button onclick="repairAllPlayersStickers()" style="background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 14px;">
                                        üîÑ Recalculer tous les streaks
                                    </button>
                                </div>

                                <!-- Info gel mensuel -->
                                <div style="background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 12px; padding: 20px;">
                                    <h4 style="margin: 0 0 10px 0; color: #374151;">‚ÑπÔ∏è R√®gles des streaks</h4>
                                    <ul style="color: #4b5563; font-size: 14px; margin: 0; padding-left: 20px; line-height: 1.8;">
                                        <li><strong>1 gel par mois</strong> : un oubli de 1-2 jours ne casse pas le streak</li>
                                        <li><strong>P√©riodes de repos</strong> : les vacances ne cassent pas le streak</li>
                                        <li><strong>Stickers permanents</strong> : une fois gagn√©, jamais perdu</li>
                                        <li><strong>Streak max historique</strong> : les stickers sont bas√©s sur le meilleur streak atteint, pas le courant</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Ajouter une joueuse -->
    <div id="addPlayerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Ajouter une joueuse</h2>
            </div>
            <div class="modal-body">
                <form id="addPlayerForm">
                    <!-- Photo d√©sactiv√©e (n√©cessite Firebase Blaze) -->
                    <div class="form-group" style="display: none;">
                        <label class="form-label">Photo de profil</label>
                        <div class="image-upload-container" onclick="document.getElementById('playerPhoto').click()">
                            <img id="photoPreview" class="image-preview" style="display: none;" />
                            <div id="uploadPlaceholder">
                                <div class="upload-icon">üì∑</div>
                                <p style="color: var(--color-text-secondary);">Cliquez pour ajouter une photo</p>
                            </div>
                        </div>
                        <input type="file" id="playerPhoto" accept="image/*" style="display: none;" onchange="previewPhoto(event)">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nom complet</label>
                        <input type="text" class="form-control" id="playerFullName" placeholder="Ex: JULIA PROU" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ID (identifiant unique)</label>
                        <input type="text" class="form-control" id="playerId" placeholder="Ex: Julia" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Date de naissance</label>
                        <input type="date" class="form-control" id="playerBirthday" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Club</label>
                        <input type="text" class="form-control" id="playerClub" placeholder="Ex: SCO Volley Sabl√©" value="SCO Volley Sabl√©">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Lat√©ralit√©</label>
                        <select class="form-control" id="playerLaterality" required>
                            <option value="">S√©lectionner...</option>
                            <option value="Droiti√®re">Droiti√®re</option>
                            <option value="Gauch√®re">Gauch√®re</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Poste</label>
                        <select class="form-control" id="playerPosition" required>
                            <option value="">S√©lectionner...</option>
                            <option value="Lib√©ro">Lib√©ro</option>
                            <option value="Aili√®re">Aili√®re</option>
                            <option value="Centrale">Centrale</option>
                            <option value="Passeuse">Passeuse</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAddPlayerModal()">Annuler</button>
                <button class="btn btn-primary" onclick="saveNewPlayer()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Modal Modifier Profil Joueuse -->
    <div id="editPlayerModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title">‚úèÔ∏è Modifier le profil</h2>
            </div>
            <div class="modal-body">
                <form id="editPlayerForm">
                    <input type="hidden" id="editPlayerId">
                    
                    <!-- Informations de base -->
                    <div style="background: #f9fafb; padding: var(--space-16); border-radius: var(--radius-base); margin-bottom: var(--space-20);">
                        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold); color: var(--color-text); margin-bottom: var(--space-12);">üìã Informations de base</h3>
                        
                        <div class="form-group">
                            <label class="form-label">Nom complet</label>
                            <input type="text" class="form-control" id="editPlayerName" placeholder="Ex: JULIA PROU" required>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-12);">
                            <div class="form-group">
                                <label class="form-label">Date de naissance</label>
                                <input type="date" class="form-control" id="editPlayerBirthday" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Club</label>
                                <input type="text" class="form-control" id="editPlayerClub" placeholder="Ex: SCO Volley Sabl√©">
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-12);">
                            <div class="form-group">
                                <label class="form-label">Anciennet√© en p√¥le</label>
                                <input type="number" class="form-control" id="editPlayerSeniority" placeholder="Ex: 2" min="0">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Axe d√©veloppement prioritaire en muscu</label>
                            <input type="text" class="form-control" id="editPlayerMuscuPriority" placeholder="Ex: Force vitesse">
                        </div>
                    </div>

                    <!-- Informations physiques -->
                    <div style="background: #f0f9ff; padding: var(--space-16); border-radius: var(--radius-base); margin-bottom: var(--space-20);">
                        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold); color: var(--color-text); margin-bottom: var(--space-12);">üìè ANTHROPO - Mensurations physiques</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                            <div class="form-group">
                                <label class="form-label">Taille (cm)</label>
                                <input type="number" class="form-control" id="editPlayerHeight" placeholder="Ex: 175" min="140" max="220" step="1">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Poids (kg)</label>
                                <input type="number" class="form-control" id="editPlayerWeight" placeholder="Ex: 65" min="40" max="150" step="0.1">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Longueur membre inf. (cm)</label>
                                <input type="number" class="form-control" id="editPlayerLegLength" placeholder="Ex: 95" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Taille assise (cm)</label>
                                <input type="number" class="form-control" id="editPlayerSittingHeight" placeholder="Ex: 96" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Envergure (cm)</label>
                                <input type="number" class="form-control" id="editPlayerWingspan" placeholder="Ex: 178" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">% Masse grasse (%)</label>
                                <input type="number" class="form-control" id="editPlayerBodyFat" placeholder="Ex: 15" min="0" max="50" step="0.1">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Hauteur 1 bras (cm)</label>
                                <input type="number" class="form-control" id="editPlayerHeight1B" placeholder="Ex: 231" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Hauteur 2 bras (cm)</label>
                                <input type="number" class="form-control" id="editPlayerHeight2B" placeholder="Ex: 229" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Grip Gauche</label>
                                <input type="number" class="form-control" id="editPlayerGripLeft" placeholder="Ex: 40" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Grip Droit</label>
                                <input type="number" class="form-control" id="editPlayerGripRight" placeholder="Ex: 42" min="0">
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-12); margin-top: var(--space-12);">
                            <div class="form-group">
                                <label class="form-label">Poste</label>
                                <select class="form-control" id="editPlayerPosition">
                                    <option value="">-- S√©lectionner --</option>
                                    <option value="Lib√©ro">Lib√©ro</option>
                                    <option value="Centrale">Centrale</option>
                                    <option value="Passeuse">Passeuse</option>
                                    <option value="Pointue">Pointue</option>
                                    <option value="R√©ceptionneuse-Attaquante">R√©ceptionneuse-Attaquante</option>
                                    <option value="Universelle">Universelle</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Lat√©ralit√©</label>
                                <select class="form-control" id="editPlayerHandedness">
                                    <option value="">-- S√©lectionner --</option>
                                    <option value="Droitier">Droitier</option>
                                    <option value="Gaucher">Gaucher</option>
                                    <option value="Ambidextre">Ambidextre</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Tests Volley -->
                    <div style="background: #fef3c7; padding: var(--space-16); border-radius: var(--radius-base); margin-bottom: var(--space-20);">
                        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold); color: var(--color-text); margin-bottom: var(--space-12);">üèê TEST VOLLEY</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                            <div class="form-group">
                                <label class="form-label">Saut avec √©lan (cm)</label>
                                <input type="number" class="form-control" id="editPlayerJumpWithRun" placeholder="Ex: 281" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Saut sans √©lan (cm)</label>
                                <input type="number" class="form-control" id="editPlayerJumpStanding" placeholder="Ex: 269" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Broad jump (cm)</label>
                                <input type="number" class="form-control" id="editPlayerBroadJump" placeholder="Ex: 210" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Lancer MB CAV (cm)</label>
                                <input type="number" class="form-control" id="editPlayerMbCAV" placeholder="Ex: 690" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Lancer MB gauche (cm)</label>
                                <input type="number" class="form-control" id="editPlayerMbLeftFront" placeholder="Ex: 655" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Lancer MB poitrine (cm)</label>
                                <input type="number" class="form-control" id="editPlayerMbChest" placeholder="Ex: 540" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Lancer MB droite (cm)</label>
                                <input type="number" class="form-control" id="editPlayerMbRightFront" placeholder="Ex: 540" min="0">
                            </div>
                        </div>
                    </div>

                    <!-- Tests Muscu -->
                    <div style="background: #fee2e2; padding: var(--space-16); border-radius: var(--radius-base); margin-bottom: var(--space-20);">
                        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold); color: var(--color-text); margin-bottom: var(--space-12);">üí™ TEST MUSCU</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-12); margin-bottom: var(--space-16);">
                            <div class="form-group">
                                <label class="form-label">Vitesse Chrono 3x6m (sec)</label>
                                <input type="number" class="form-control" id="editPlayerSpeedChrono" placeholder="Ex: 3.2" step="0.01">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Chrono 5m d√©part signal (sec)</label>
                                <input type="number" class="form-control" id="editPlayerChrono5m" placeholder="Ex: 1.1" step="0.01">
                            </div>
                        </div>

                        <!-- DC -->
                        <fieldset style="border: 1px solid #ccc; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <legend style="font-weight: 600; padding: 0 8px;">DC (D√©velopp√© Couch√©)</legend>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                                <div class="form-group">
                                    <label class="form-label">REP</label>
                                    <input type="number" class="form-control" id="editPlayerDcRep" placeholder="Ex: 6" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CHARGE (kg)</label>
                                    <input type="number" class="form-control" id="editPlayerDcCharge" placeholder="Ex: 32.5" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="color: #059669;">MAX (auto)</label>
                                    <input type="text" class="form-control" id="editPlayerDcMax" readonly style="background: #f0fdf4; color: #059669; font-weight: 600;">
                                </div>
                            </div>
                        </fieldset>

                        <!-- TRACTION -->
                        <fieldset style="border: 1px solid #ccc; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <legend style="font-weight: 600; padding: 0 8px;">TRACTION</legend>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                                <div class="form-group">
                                    <label class="form-label">REP</label>
                                    <input type="number" class="form-control" id="editPlayerTractionRep" placeholder="Ex: 6" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CHARGE (kg)</label>
                                    <input type="number" class="form-control" id="editPlayerTractionCharge" placeholder="Ex: 25.5" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="color: #059669;">MAX (auto)</label>
                                    <input type="text" class="form-control" id="editPlayerTractionMax" readonly style="background: #f0fdf4; color: #059669; font-weight: 600;">
                                </div>
                            </div>
                        </fieldset>

                        <!-- TIRAGE BANC -->
                        <fieldset style="border: 1px solid #ccc; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <legend style="font-weight: 600; padding: 0 8px;">TIRAGE BANC</legend>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                                <div class="form-group">
                                    <label class="form-label">REP</label>
                                    <input type="number" class="form-control" id="editPlayerTirageRep" placeholder="Ex: 6" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CHARGE (kg)</label>
                                    <input type="number" class="form-control" id="editPlayerTirageCharge" placeholder="Ex: 33" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="color: #059669;">MAX (auto)</label>
                                    <input type="text" class="form-control" id="editPlayerTirageMax" readonly style="background: #f0fdf4; color: #059669; font-weight: 600;">
                                </div>
                            </div>
                        </fieldset>

                        <!-- PULL OVER -->
                        <fieldset style="border: 1px solid #ccc; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <legend style="font-weight: 600; padding: 0 8px;">PULL OVER</legend>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                                <div class="form-group">
                                    <label class="form-label">REP</label>
                                    <input type="number" class="form-control" id="editPlayerPullOverRep" placeholder="Ex: 6" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CHARGE (kg)</label>
                                    <input type="number" class="form-control" id="editPlayerPullOverCharge" placeholder="Ex: 16" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="color: #059669;">MAX (auto)</label>
                                    <input type="text" class="form-control" id="editPlayerPullOverMax" readonly style="background: #f0fdf4; color: #059669; font-weight: 600;">
                                </div>
                            </div>
                        </fieldset>

                        <!-- HIP THRUST -->
                        <fieldset style="border: 1px solid #ccc; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <legend style="font-weight: 600; padding: 0 8px;">HIP THRUST</legend>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                                <div class="form-group">
                                    <label class="form-label">REP</label>
                                    <input type="number" class="form-control" id="editPlayerHipThrustRep" placeholder="Ex: 6" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CHARGE (kg)</label>
                                    <input type="number" class="form-control" id="editPlayerHipThrustCharge" placeholder="Ex: 30.5" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="color: #059669;">MAX (auto)</label>
                                    <input type="text" class="form-control" id="editPlayerHipThrustMax" readonly style="background: #f0fdf4; color: #059669; font-weight: 600;">
                                </div>
                            </div>
                        </fieldset>

                        <!-- SDT -->
                        <fieldset style="border: 1px solid #ccc; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <legend style="font-weight: 600; padding: 0 8px;">SDT (Soulev√© de Terre)</legend>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                                <div class="form-group">
                                    <label class="form-label">REP</label>
                                    <input type="number" class="form-control" id="editPlayerSdtRep" placeholder="Ex: 6" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CHARGE (kg)</label>
                                    <input type="number" class="form-control" id="editPlayerSdtCharge" placeholder="Ex: 28" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="color: #059669;">MAX (auto)</label>
                                    <input type="text" class="form-control" id="editPlayerSdtMax" readonly style="background: #f0fdf4; color: #059669; font-weight: 600;">
                                </div>
                            </div>
                        </fieldset>

                        <!-- BACK SQUAT -->
                        <fieldset style="border: 1px solid #ccc; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                            <legend style="font-weight: 600; padding: 0 8px;">BACK SQUAT</legend>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                                <div class="form-group">
                                    <label class="form-label">REP</label>
                                    <input type="number" class="form-control" id="editPlayerBackSquatRep" placeholder="Ex: 6" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CHARGE (kg)</label>
                                    <input type="number" class="form-control" id="editPlayerBackSquatCharge" placeholder="Ex: 63" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="color: #059669;">MAX (auto)</label>
                                    <input type="text" class="form-control" id="editPlayerBackSquatMax" readonly style="background: #f0fdf4; color: #059669; font-weight: 600;">
                                </div>
                            </div>
                        </fieldset>

                        <!-- √âPAULE -->
                        <fieldset style="border: 1px solid #ccc; padding: 12px; border-radius: 6px;">
                            <legend style="font-weight: 600; padding: 0 8px;">√âPAULE</legend>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                                <div class="form-group">
                                    <label class="form-label">REP</label>
                                    <input type="number" class="form-control" id="editPlayerEpauleRep" placeholder="Ex: 6" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CHARGE (kg)</label>
                                    <input type="number" class="form-control" id="editPlayerEpauleCharge" placeholder="Ex: 12" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" style="color: #059669;">MAX (auto)</label>
                                    <input type="text" class="form-control" id="editPlayerEpauleMax" readonly style="background: #f0fdf4; color: #059669; font-weight: 600;">
                                </div>
                            </div>
                        </fieldset>
                    </div>

                    <!-- Tests Physio -->
                    <div style="background: #dcfce7; padding: var(--space-16); border-radius: var(--radius-base);">
                        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-semibold); color: var(--color-text); margin-bottom: var(--space-12);">üèÉ TEST PHYSIO - VMA (Navette)</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--space-12);">
                            <div class="form-group">
                                <label class="form-label">Temps (sec)</label>
                                <input type="number" class="form-control" id="editPlayerVmaTime" placeholder="Ex: 5.2" step="0.1">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Palier</label>
                                <input type="number" class="form-control" id="editPlayerVmaPalier" placeholder="Ex: 12" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Date test VMA</label>
                                <input type="date" class="form-control" id="editPlayerVmaDate">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditPlayerModal()">Annuler</button>
                <button class="btn btn-primary" onclick="savePlayerEdit()">üíæ Enregistrer les modifications</button>
            </div>
        </div>
    </div>

<!-- AJOUT APR√àS LA LIGNE 809 (avant </body>) -->

    <!-- Modal D√©tails Joueuse -->
    <div id="playerDetailModal" class="modal">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <!-- EN-T√äTE -->
            <div class="modal-header" style="display: flex; align-items: center; gap: 16px; padding: 20px 24px; border-bottom: 1px solid #e5e7eb; position: sticky; top: 0; background: white; z-index: 10;">
                <div id="playerDetailAvatar" style="width: 64px; height: 64px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: bold; overflow: hidden; flex-shrink: 0;">
                    <img id="playerDetailPhoto" src="" style="width: 100%; height: 100%; object-fit: cover; display: none;" alt="Photo">
                    <span id="playerDetailInitials">--</span>
                </div>
                <div style="flex: 1;">
                    <div id="playerDetailFullName" style="font-size: 20px; font-weight: 600; color: #1f2937;"></div>
                    <div id="playerDetailBirthday" style="font-size: 14px; color: #6b7280;"></div>
                </div>
                <span id="playerDetailBadge" class="status-badge" style="padding: 6px 16px; border-radius: 20px; font-size: 14px; font-weight: 500;"></span>
                <button onclick="closePlayerDetailModal()" style="background: none; border: none; font-size: 24px; color: #9ca3af; cursor: pointer; margin-left: 8px;">√ó</button>
            </div>

            <div class="modal-body" style="padding: 0;">
                <!-- SCORE ACTUEL -->
                <div style="text-align: center; padding: 20px; background: #f9fafb; border-bottom: 1px solid #e5e7eb;">
                    <div style="font-size: 14px; color: #6b7280; margin-bottom: 4px;">Score actuel</div>
                    <div id="playerDetailScoreBig" style="font-size: 48px; font-weight: 700; color: #f59e0b;">0/10</div>
                </div>

                <!-- CYCLE MENSTRUEL -->
                <div id="popupCycleSection" style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb; display: none;">
                    <!-- G√©n√©r√© par JS -->
                </div>

                <!-- VOLUME D'ENTRA√éNEMENT -->
                <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb;">
                    <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 16px;">üèãÔ∏è Volume d'entra√Ænement</div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                        <div style="text-align: center; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Cette semaine</div>
                            <div id="detailWeeklyHours" style="font-size: 28px; font-weight: 700; color: #667eea;">0h</div>
                            <div style="font-size: 12px; color: #9ca3af;">/ 20h</div>
                        </div>
                        <div style="text-align: center; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Ce mois</div>
                            <div id="detailMonthlyHours" style="font-size: 28px; font-weight: 700; color: #667eea;">0h</div>
                        </div>
                        <div style="text-align: center; padding: 16px; background: #f9fafb; border-radius: 12px;">
                            <div style="font-size: 12px; color: #6b7280; margin-bottom: 4px;">Cette ann√©e</div>
                            <div id="detailYearlyHours" style="font-size: 28px; font-weight: 700; color: #667eea;">0h</div>
                            <div style="font-size: 12px; color: #9ca3af;">/ 720h</div>
                        </div>
                    </div>
                </div>

                <!-- TENDANCE 6 SEMAINES (CHARGE) -->
                <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb;">
                    <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 16px;">üìà Tendance Charge (6 derni√®res semaines)</div>
                    <div style="height: 200px;">
                        <canvas id="popupTrendChart"></canvas>
                    </div>
                </div>

                <!-- DERNIER CHECK-IN -->
                <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb;">
                    <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 16px;">‚úÖ Dernier Check-in</div>
                    <div id="lastCheckinDate" style="font-size: 14px; color: #6b7280; margin-bottom: 12px;">--</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f9fafb; border-radius: 8px;">
                            <span style="font-size: 14px; color: #374151;">üò¥ Sommeil</span>
                            <span id="lastCheckinSleep" style="font-weight: 600; color: #1f2937;">--/10</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f9fafb; border-radius: 8px;">
                            <span style="font-size: 14px; color: #374151;">üí™ Courbatures</span>
                            <span id="lastCheckinSoreness" style="font-weight: 600; color: #1f2937;">--/10</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f9fafb; border-radius: 8px;">
                            <span style="font-size: 14px; color: #374151;">üò∞ Stress</span>
                            <span id="lastCheckinStress" style="font-weight: 600; color: #1f2937;">--/10</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f9fafb; border-radius: 8px;">
                            <span style="font-size: 14px; color: #374151;">üòä Humeur</span>
                            <span id="lastCheckinMood" style="font-weight: 600; color: #1f2937;">--/10</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f9fafb; border-radius: 8px; grid-column: span 2;">
                            <span style="font-size: 14px; color: #374151;">‚ö° √ânergie</span>
                            <span id="lastCheckinEnergy" style="font-weight: 600; color: #1f2937;">--/10</span>
                        </div>
                    </div>
                    <div id="lastCheckinComment" style="padding: 12px; background: #f0f9ff; border-radius: 8px; border-left: 3px solid #667eea; font-style: italic; color: #374151; display: none;"></div>
                    <div style="text-align: center; padding: 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; margin-top: 16px;">
                        <div style="font-size: 14px; opacity: 0.9;">Score de pr√©paration</div>
                        <div id="lastCheckinScore" style="font-size: 36px; font-weight: 700;">--%</div>
                    </div>
                </div>

                <!-- GRAPHIQUE CYCLE MENSTRUEL -->
                <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb;">
                    <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 12px;">üå∏ Cycle Menstruel</div>
                    <!-- Navigation cycles avec fl√®ches -->
                    <div id="popupCycleNavigation" style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                        <button id="popupCyclePrev" onclick="navigatePopupCycle(-1)" style="padding: 6px 10px; border-radius: 6px; border: 1px solid #e5e7eb; background: white; color: #374151; cursor: pointer; font-size: 14px;">‚óÄ</button>
                        <span id="popupCycleLabel" style="padding: 6px 16px; border-radius: 6px; background: #667eea; color: white; font-size: 12px; font-weight: 600; min-width: 100px; text-align: center;">Cycle Actuel</span>
                        <button id="popupCycleNext" onclick="navigatePopupCycle(1)" style="padding: 6px 10px; border-radius: 6px; border: 1px solid #e5e7eb; background: white; color: #374151; cursor: pointer; font-size: 14px; opacity: 0.3;" disabled>‚ñ∂</button>
                    </div>
                    <div id="popupCycleChartContainer" style="position: relative; height: 300px;">
                        <canvas id="popupCycleChart"></canvas>
                    </div>
                    <div id="popupCycleChartEmpty" style="text-align: center; padding: 40px; color: #9ca3af; display: none;">
                        <div style="font-size: 32px; margin-bottom: 8px;">üìä</div>
                        <p>Aucune donn√©e de cycle disponible</p>
                    </div>
                    <div id="popupCycleAnnotations" style="margin-top: 12px;"></div>
                </div>

                <!-- HISTORIQUE CHECK-INS -->
                <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb;">
                    <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 16px;">üìã Historique Check-ins (7 derniers jours)</div>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                            <thead>
                                <tr style="background: #f9fafb;">
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Date</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Sommeil</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Courbatures</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Stress</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Humeur</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">√ânergie</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Score</th>
                                </tr>
                            </thead>
                            <tbody id="checkinsHistoryTable">
                                <!-- G√©n√©r√© par JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- HISTORIQUE SESSIONS RPE -->
                <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb;">
                    <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 16px;">üèÉ Historique Sessions RPE (7 derni√®res)</div>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                            <thead>
                                <tr style="background: #f9fafb;">
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Date</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Type</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">RPE</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Dur√©e (min)</th>
                                    <th style="text-align: left; padding: 12px 8px; color: #6b7280; font-weight: 500; border-bottom: 1px solid #e5e7eb;">Charge</th>
                                </tr>
                            </thead>
                            <tbody id="rpeHistoryTable">
                                <!-- G√©n√©r√© par JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- TESTS PHYSIQUES -->
                <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;">üìä Tests Physiques</div>
                        <button onclick="showPlayerTests(window.currentPopupPlayerId)" 
                                style="background: #4ECDC4; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">
                            Voir les tests
                        </button>
                    </div>
                    <div id="playerTestsContent" style="display: none;">
                        <!-- G√©n√©r√© par player-tests-visualization.js -->
                    </div>
                </div>

                <!-- GRAPHIQUES -->
                <div style="padding: 20px 24px;">
                    <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 16px;">üìä Graphiques</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div style="background: #f9fafb; border-radius: 12px; padding: 16px;">
                            <div style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 12px;">√âvolution Pr√©paration (7j)</div>
                            <div style="height: 180px;">
                                <canvas id="popupPrepChart"></canvas>
                            </div>
                        </div>
                        <div style="background: #f9fafb; border-radius: 12px; padding: 16px;">
                            <div style="font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 12px;">Charge ATL/CTL (28j)</div>
                            <div style="height: 180px;">
                                <canvas id="popupAtlCtlChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer" style="border-top: 1px solid #e5e7eb; padding: 16px 24px; display: flex; justify-content: space-between;">
                <button class="btn btn-danger" onclick="deletePlayer()" style="background: #fee2e2; color: #dc2626; border: 1px solid #fecaca;">üóëÔ∏è Supprimer</button>
                <div style="display: flex; gap: var(--space-8);">
                    <button class="btn btn-primary" onclick="editPlayerFromPopup()" style="background: var(--color-primary); color: white;">‚úèÔ∏è Modifier</button>
                    <button class="btn btn-secondary" onclick="closePlayerDetailModal()">Fermer</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal D√©clarer une blessure -->
    <div id="newInjuryModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title">D√©clarer une blessure</h2>
                <button id="closeInjuryModal" class="btn btn-secondary">‚úï</button>
            </div>
            <div class="modal-body">
                <form id="newInjuryForm">
                    <div class="form-group">
                        <label class="form-label">Joueuse *</label>
                        <select id="injuryPlayerId" name="playerId" class="form-control" required>
                            <option value="">S√©lectionner une joueuse</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Date de la blessure *</label>
                        <input type="date" name="injuryDate" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Type de blessure *</label>
                        <select name="injuryType" class="form-control" required>
                            <option value="">S√©lectionner un type</option>
                            <option value="ankle_sprain">Entorse cheville</option>
                            <option value="knee_tendinitis">Tendinite genou</option>
                            <option value="muscle_tear">D√©chirure musculaire</option>
                            <option value="finger_sprain">Entorse doigt</option>
                            <option value="shoulder_pain">Douleur √©paule</option>
                            <option value="back_pain">Douleur dos</option>
                            <option value="knee_pain">Douleur genou</option>
                            <option value="ankle_pain">Douleur cheville</option>
                            <option value="wrist_sprain">Entorse poignet</option>
                            <option value="thigh_strain">√âlongation cuisse</option>
                            <option value="calf_strain">√âlongation mollet</option>
                            <option value="other">Autre (√† pr√©ciser)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Zone corporelle *</label>
                        <select name="bodyZone" class="form-control" required>
                            <option value="">S√©lectionner une zone</option>
                            <option value="ankle">Cheville</option>
                            <option value="knee">Genou</option>
                            <option value="thigh">Cuisse</option>
                            <option value="calf">Mollet</option>
                            <option value="shoulder">√âpaule</option>
                            <option value="elbow">Coude</option>
                            <option value="wrist">Poignet</option>
                            <option value="finger">Doigt</option>
                            <option value="back">Dos</option>
                            <option value="hip">Hanche</option>
                            <option value="other">Autre</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Gravit√© *</label>
                        <select name="severity" class="form-control" required>
                            <option value="">S√©lectionner la gravit√©</option>
                            <option value="1">L√©g√®re (1-7 jours)</option>
                            <option value="2">Mod√©r√©e (1-4 semaines)</option>
                            <option value="3">Grave (1-3 mois)</option>
                            <option value="4">Tr√®s grave (3+ mois)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Circonstance *</label>
                        <select name="circumstance" class="form-control" required>
                            <option value="">S√©lectionner</option>
                            <option value="training">Entra√Ænement</option>
                            <option value="match">Match</option>
                            <option value="other">Hors volleyball</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Commentaires (optionnel)</label>
                        <textarea name="comments" class="form-control" rows="3" placeholder="D√©tails suppl√©mentaires..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeNewInjuryModal()">Annuler</button>
                <button class="btn btn-primary" onclick="document.getElementById('newInjuryForm').dispatchEvent(new Event('submit'))">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Modal de cr√©ation de message urgent -->
    <div id="urgentMessageModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 16px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="padding: 25px; border-bottom: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="margin: 0; font-size: 24px; color: #1a1a1a;">üì¢ Nouveau Message Urgent</h2>
                <button onclick="closeUrgentMessageModal()" style="background: none; border: none; font-size: 28px; cursor: pointer; color: #666; line-height: 1; padding: 0; width: 32px; height: 32px; transition: color 0.2s;" onmouseover="this.style.color='#E63946'" onmouseout="this.style.color='#666'">√ó</button>
            </div>
            
            <form id="urgentMessageForm" onsubmit="saveUrgentMessage(event)" style="padding: 25px;">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Message <span style="color: #E63946;">*</span></label>
                    <textarea name="messageText" id="messageText" required maxlength="200" rows="4" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; font-family: inherit; resize: vertical;" placeholder="Entrez votre message (max 200 caract√®res)"></textarea>
                    <div style="text-align: right; margin-top: 5px; font-size: 13px; color: #666;">
                        <span id="charCount">0</span> / 200 caract√®res
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Date d'affichage <span style="color: #E63946;">*</span></label>
                    <input type="date" name="displayDate" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px;">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Priorit√© <span style="color: #E63946;">*</span></label>
                    <select name="priority" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; cursor: pointer;">
                        <option value="normal">üì¢ Normal</option>
                        <option value="urgent">‚ö†Ô∏è Urgent (rouge)</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <label style="display: block; margin-bottom: 12px; font-weight: 600; color: #333;">Destinataires <span style="color: #E63946;">*</span></label>
                    <div id="targetPlayersCheckboxes" style="max-height: 200px; overflow-y: auto; border: 2px solid #e0e0e0; border-radius: 8px; padding: 12px;">
                        Chargement...
                    </div>
                </div>
                
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button type="button" onclick="closeUrgentMessageModal()" style="padding: 12px 24px; background: #f5f5f5; color: #333; border: none; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#e0e0e0'" onmouseout="this.style.background='#f5f5f5'">
                        Annuler
                    </button>
                    <button type="submit" style="padding: 12px 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
                        üìÖ Programmer
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal P√©riode de Repos -->
    <div id="restPeriodModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 16px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
            <div style="padding: 25px; border-bottom: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                <h2 id="restPeriodModalTitle" style="margin: 0; font-size: 24px; color: #1a1a1a;">‚è∏Ô∏è Nouvelle P√©riode de Repos</h2>
                <button onclick="closeRestPeriodModal()" style="background: none; border: none; font-size: 28px; color: #999; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: background 0.2s;" onmouseover="this.style.background='#f0f0f0'" onmouseout="this.style.background='none'">
                    √ó
                </button>
            </div>
            <form id="restPeriodForm" onsubmit="saveRestPeriod(event)" style="padding: 25px;">
                <!-- Type de p√©riode -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #34495e;">Type de p√©riode *</label>
                    <select id="restPeriodType" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; transition: border-color 0.3s ease;">
                        <option value="">-- S√©lectionner --</option>
                        <option value="Vacances">Vacances</option>
                        <option value="Week-ends">Week-ends</option>
                        <option value="Jours f√©ri√©s">Jours f√©ri√©s</option>
                        <option value="Autre">Autre</option>
                    </select>
                </div>

                <!-- Dates -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #34495e;">Date de d√©but *</label>
                        <input type="date" id="restPeriodStartDate" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #34495e;">Date de fin *</label>
                        <input type="date" id="restPeriodEndDate" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                    </div>
                </div>

                <!-- Option week-ends -->
                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="restPeriodWeekendsEnabled" style="width: 20px; height: 20px; margin-right: 12px; cursor: pointer;">
                        <span style="font-weight: 600; color: #34495e;">Bloquer tous les week-ends (samedi et dimanche)</span>
                    </label>
                    <p style="margin: 8px 0 0 32px; font-size: 14px; color: #7f8c8d;">Si activ√©, le Check-in sera bloqu√© tous les samedis et dimanches (le RPE reste accessible).</p>
                </div>

                <!-- Message personnalis√© -->
                <div style="margin-bottom: 25px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #34495e;">Message pour les joueuses *</label>
                    <textarea id="restPeriodMessage" required rows="3" maxlength="200" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; font-family: inherit; resize: vertical;" placeholder="Ex: Bonnes vacances ! Le RPE reste accessible pour vos activit√©s sportives üèñÔ∏è"></textarea>
                    <p style="margin: 5px 0 0 0; font-size: 13px; color: #95a5a6; text-align: right;"><span id="restPeriodMessageCount">0</span>/200 caract√®res</p>
                </div>

                <!-- Boutons -->
                <div style="display: flex; gap: 15px; justify-content: flex-end;">
                    <button type="button" onclick="closeRestPeriodModal()" style="padding: 12px 30px; border: 2px solid #e0e0e0; background: white; color: #7f8c8d; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                        Annuler
                    </button>
                    <button type="submit" style="padding: 12px 30px; border: none; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: all 0.3s ease;">
                        Enregistrer
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
    // Compteur de caract√®res pour le message
    document.addEventListener('DOMContentLoaded', function() {
        const messageTextarea = document.getElementById('messageText');
        const charCount = document.getElementById('charCount');
        
        if (messageTextarea && charCount) {
            messageTextarea.addEventListener('input', function() {
                charCount.textContent = this.value.length;
            });
        }
    });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Cache Buster for iOS -->
    <script>
        const cacheBuster = '?v=' + new Date().getTime();
        document.addEventListener('DOMContentLoaded', () => {
            // Force reload of scripts to bypass cache on iOS
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                console.log('iOS detected - forcing cache bypass');
                // Unregister old service workers
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.getRegistrations().then(registrations => {
                        registrations.forEach(reg => reg.unregister());
                    });
                }
            }
        });
    </script>
    <script src="/js/app.js"></script>
    <script src="/js/app-additions.js"></script>
    <script src="/js/app-photo-manager-simple.js"></script>
    <script src="/js/app-rpe-delete-SIMPLE.js"></script>
    <script src="/js/load-calculator.js"></script>
    <script src="/js/streaks.js"></script>
    <script src="/js/training-streaks.js"></script>
    
    <!-- Syst√®me de Stickers -->
    <script src="/js/stickers.js"></script>
    <script src="/js/sticker-animation.js"></script>
    <script src="/js/sticker-collection.js"></script>
    <script src="/js/admin-stickers-repair.js"></script>

    <!-- Weekend Match Recap -->
    <script src="/js/weekend-match-recap.js"></script>
    
    <script src="/js/engagement-dashboard.js"></script>
    <script src="/js/app-reports.js"></script>
    <script src="/js/app-rattrapage.js"></script>
    <script src="/js/app-volume-stats.js"></script>
    <script src="/js/injury-constants.js"></script>
    <script src="/js/injury-management.js"></script>
    <script src="/js/notifications-manager.js"></script>
    <script src="/js/rest-periods-helper-COMPATIBLE.js"></script>
    <script src="/js/rest-periods-manager.js"></script>
    <script src="/js/player-dashboard-charts.js"></script>
    <script src="/js/cycle-chart-fullscreen.js"></script>
    <script src="/js/coach-dashboard-charts.js"></script>
    <script src="/js/health-alerts.js"></script>
    <script src="/js/training-recommendations.js"></script>
    <script src="/js/week-planner.js"></script>
    <script src="/js/team-planner.js"></script>
    <script src="/js/coach-alerts.js"></script>
    <script src="/js/coach-notifications-simple.js"></script>
    <script src="/js/admin-tools.js"></script>
    <script src="/js/rating-badges.js"></script>
    <!-- Module Cycle Menstruel - Check-in joueuses (DOIT √äTRE CHARG√â AVANT cycle-badges.js) -->
    <script src="/js/cycle-checkin.js"></script>
    <script src="/js/cycle-badges.js"></script>
    <script src="/js/rpe-progressive-ui.js"></script>
    <!-- Biblioth√®que ExcelJS pour export Excel avec mise en forme compl√®te -->
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js"></script>
    
    <script src="/js/push-notifications.js"></script>
    <script src="/js/player-popup.js"></script>
    <script src="/js/player-tests-visualization.js"></script>
    <script src="/js/physical-tests-manager.js"></script>
    <script src="/js/player-management.js"></script>
    <script src="/js/rpe-history-delete.js"></script>
    <!-- Module Questionnaire Cycle Complet - 12 questions -->
    <script src="/js/cycle-questionnaire-complet.js"></script>
    <script src="/js/cycle-detection-module.js"></script>
    <!-- Module Export PDF -->
    <script src="/js/pdf-export.js"></script>
    <!-- Module Settings Modal -->
    <script src="/js/settings-modal.js"></script>
    <!-- Module Motivational Quotes -->
    <script src="/js/motivational-quotes.js"></script>
    <!-- Initialize Motivational Quote on app startup -->
    <script>
        document.addEventListener('DOMContentLoaded', showDailyMotivation);
    </script>

</body>
</html>

